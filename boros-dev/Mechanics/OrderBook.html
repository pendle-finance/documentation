<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-boros-dev docs-version-current docs-doc-page docs-doc-id-Mechanics/OrderBook" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Central Limit Order Book | Pendle Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pendle.finance/boros-dev/Mechanics/OrderBook"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-boros-dev-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-boros-dev-current"><meta data-rh="true" property="og:title" content="Central Limit Order Book | Pendle Documentation"><meta data-rh="true" name="description" content="Boros implements a gas-optimized central limit order book (CLOB) specifically designed for the EVM. The order book architecture minimizes gas costs through lazy settlement and efficient data structures while maintaining the functionality expected from professional trading platforms."><meta data-rh="true" property="og:description" content="Boros implements a gas-optimized central limit order book (CLOB) specifically designed for the EVM. The order book architecture minimizes gas costs through lazy settlement and efficient data structures while maintaining the functionality expected from professional trading platforms."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pendle.finance/boros-dev/Mechanics/OrderBook"><link data-rh="true" rel="alternate" href="https://pendle.finance/boros-dev/Mechanics/OrderBook" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://pendle.finance/cn/boros-dev/Mechanics/OrderBook" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pendle.finance/boros-dev/Mechanics/OrderBook" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ“Š Order Book","item":"https://pendle.finance/boros-dev/Mechanics/OrderBook"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6ZBS49V0YS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-6ZBS49V0YS",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Pendle Documentation" href="/opensearch.xml">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1e78c9e4.css">
<script src="/assets/js/runtime~main.9c4fa98c.js" defer="defer"></script>
<script src="/assets/js/main.336a0c75.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12h18m-9-9h9m-9 18h9"></path></svg></button><a href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Pendle"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Pendle V2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/pendle-v2/Introduction">Pendle V2 Docs</a></li><li><a href="https://pendle.gitbook.io/pendle-academy/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Pendle Academy<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Boros</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/boros-dev">Boros Dev Docs</a></li><li><a href="https://pendle.gitbook.io/boros/boros-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Boros Docs<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://pendle.gitbook.io/boros" target="_blank" rel="noopener noreferrer" class="dropdown__link">Boros Academy<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="searchContainer_eKWQ"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div><div class="language-switcher" style="display:flex;align-items:center;margin-left:12px"><select style="background:rgba(248, 250, 252, 0.8);border:1px solid rgba(15, 23, 42, 0.1);border-radius:8px;padding:6px 12px;font-size:14px;color:#475569;cursor:pointer;min-width:80px"><option value="en" selected="">English</option><option value="cn">ä¸­æ–‡ï¼ˆä¸­å›½)</option></select></div></div></div></div><div class="scrollProgressLine_ACL0"></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_cWv0"><aside class="theme-doc-sidebar-container docSidebarContainer_RSuS"><div class="sidebar_mhZE"><nav class="menu thin-scrollbar menu_Y1UP"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/boros-dev">ğŸ“– Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/boros-dev/LitePaper">ğŸ“„ Lite Paper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/boros-dev/HighLevelArchitecture">ğŸ—ï¸ High Level Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/boros-dev/Mechanics/OrderBook">âš™ï¸ Mechanics</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/boros-dev/Mechanics/OrderBook">ğŸ“Š Order Book</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/boros-dev/Mechanics/Margin">ğŸ’° Margin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/boros-dev/Mechanics/Settlement">âœ… Settlement</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/boros-dev/Mechanics/Fees">ğŸ’µ Fees</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/boros-dev/Contracts/Router">ğŸ“œ Contracts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/boros-dev/Backend/overview">ğŸ”Œ Backend Integration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/boros-dev/FAQ">â“ FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_hjYf"><div class="container padding-top--md padding-bottom--lg"><div><div class="row"><div class="col"><div><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">âš™ï¸ Mechanics</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ğŸ“Š Order Book</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Central Limit Order Book</h1></header>
<p>Boros implements a gas-optimized central limit order book (CLOB) specifically designed for the EVM. The order book architecture minimizes gas costs through <a href="/boros-dev/Mechanics/Settlement">lazy settlement</a> and efficient data structures while maintaining the functionality expected from professional trading platforms.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="order-book-structure">Order Book Structure<a href="#order-book-structure" class="hash-link" aria-label="Direct link to Order Book Structure" title="Direct link to Order Book Structure">â€‹</a></h2>
<p>The order book consists of two independent sides:</p>
<ul>
<li><strong>Long Side (Bids)</strong>: Orders to buy/go long on interest rates</li>
<li><strong>Short Side (Asks)</strong>: Orders to sell/go short on interest rates</li>
</ul>
<p>Each side contains <strong>65,536 discrete rate levels</strong> (ticks) ranging from -32768 to 32767.</p>
<p>The tick system uses an exponential function to map discrete tick indices to interest rates. This design provides:</p>
<ul>
<li><strong>Compactness</strong>: Entire rate range expressed with just 16 bits</li>
<li><strong>Expressiveness</strong>: Finer granularity near zero, coarser at extremes</li>
<li><strong>Symmetry</strong>: Equal precision for positive and negative rates</li>
</ul>
<p>The tick spacing is configurable per market via the <code>tickStep</code> parameter. A larger <code>tickStep</code> creates wider rate intervals between ticks, suitable for more volatile markets.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tick-to-rate-conversion">Tick to Rate Conversion<a href="#tick-to-rate-conversion" class="hash-link" aria-label="Direct link to Tick to Rate Conversion" title="Direct link to Tick to Rate Conversion">â€‹</a></h2>
<p>The conversion between tick indices and interest rates follows an exponential formula:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>rate</mtext><mo stretchy="false">(</mo><mtext>tick</mtext><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mn>1.00005</mn><mrow><mtext>tick</mtext><mo>Ã—</mo><mtext>tickStep</mtext></mrow></msup><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ tick</mtext><mo>â‰¥</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mo stretchy="false">(</mo><msup><mn>1.00005</mn><mrow><mo>âˆ’</mo><mtext>tick</mtext><mo>Ã—</mo><mtext>tickStep</mtext></mrow></msup><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ tick</mtext><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{rate}(\text{tick}) = \begin{cases}
1.00005^{\text{tick} \times \text{tickStep}} - 1 &amp; \text{if tick} \geq 0 \\
-(1.00005^{-\text{tick} \times \text{tickStep}} - 1) &amp; \text{if tick} &lt; 0
\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">rate</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">tick</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">1.0000</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tick</span></span><span class="mbin mtight">Ã—</span><span class="mord text mtight"><span class="mord mtight">tickStep</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">âˆ’</span><span class="mopen">(</span><span class="mord">1.0000</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord text mtight"><span class="mord mtight">tick</span></span><span class="mbin mtight">Ã—</span><span class="mord text mtight"><span class="mord mtight">tickStep</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ tick</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">0</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ tick</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>The TickMath library provides conversion between tick indices and interest rates:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Convert tick to interest rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int128 rate = TickMath.getRateAtTick(tick, tickStep);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Formula: rate = 1.00005^(tick * tickStep) - 1 for tick &gt;= 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">//          rate = -(1.00005^(-tick * tickStep) - 1) for tick &lt; 0</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">â€‹</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// tickStep = 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tick = 0    -&gt; rate = 0% (neutral)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tick = 100  -&gt; rate =   1.00005^200 - 1  â‰ˆ  1.005%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tick = -100 -&gt; rate = -(1.00005^200 - 1) â‰ˆ -1.005%</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="matching-priority">Matching Priority<a href="#matching-priority" class="hash-link" aria-label="Direct link to Matching Priority" title="Direct link to Matching Priority">â€‹</a></h2>
<p>Boros order book follows the standard <strong>rate-time priority</strong> matching:</p>
<ul>
<li>Orders offering better rates are matched first<!-- -->
<ul>
<li>For long orders: Higher rates (willing to pay more) have priority</li>
<li>For short orders: Lower rates (willing to receive less) have priority</li>
</ul>
</li>
<li>Within the same rate level (tick), orders are matched in the order they were placed (FIFO)<!-- -->
<ul>
<li>The <code>orderIndex</code> within each tick determines the exact queue position</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="order-id">Order Id<a href="#order-id" class="hash-link" aria-label="Direct link to Order Id" title="Direct link to Order Id">â€‹</a></h2>
<p>Each order in Boros has a unique order Id, which a 64-bit packed value containing order metadata:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">OrderId structure (64 bits):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">â”‚ Init(1) â”‚ Side(1)  â”‚ Tick(16)    â”‚ Index(40)    â”‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bit 63: Initialization marker (always 1 for valid orders)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bit 56: Side (0 = LONG, 1 = SHORT)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bits 40-55: Encoded tick index</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bits 0-39: Order index within tick</span><br></span></code></pre></div></div>
<p>This encoding has a nice ordering property: orders with <strong>lower OrderId values</strong> have <strong>higher priority</strong> in the order book.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="parsing-orderid">Parsing OrderId<a href="#parsing-orderid" class="hash-link" aria-label="Direct link to Parsing OrderId" title="Direct link to Parsing OrderId">â€‹</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Parsing an OrderId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(Side side, int16 tickIndex, uint40 orderIndex) = OrderIdLib.unpack(orderId);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Quick access methods</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Side side = orderId.side();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int16 tick = orderId.tickIndex();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">uint40 index = orderId.orderIndex();</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="placing-orders">Placing orders<a href="#placing-orders" class="hash-link" aria-label="Direct link to Placing orders" title="Direct link to Placing orders">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="time-in-force">Time In Force<a href="#time-in-force" class="hash-link" aria-label="Direct link to Time In Force" title="Direct link to Time In Force">â€‹</a></h3>
<p>Time In Force (TIF) parameters control how orders behave during matching and placement. Boros supports five TIF types to accommodate different trading strategies:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">enum TimeInForce {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    GTC,       // Good Till Cancel - Standard limit order, remains on book until filled/cancelled</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    IOC,       // Immediate or Cancel - Executes against available liquidity, cancels unfilled portion</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FOK,       // Fill or Kill - Must fill entire size or transaction reverts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ALO,       // Add Liquidity Only - Post-only order, transaction reverts if would match</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SOFT_ALO   // Soft ALO - If order would match, it gets skipped (not placed on orderbook) and transaction doesn&#x27;t revert</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="self-trade-prevention">Self-trade Prevention<a href="#self-trade-prevention" class="hash-link" aria-label="Direct link to Self-trade Prevention" title="Direct link to Self-trade Prevention">â€‹</a></h3>
<p>Boros prevents self-trading by checking if an incoming order would match against the same account&#x27;s existing orders. If self-matching is detected, the transaction will revert to protect traders from unintentionally trading with themselves.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="restrictions">Restrictions<a href="#restrictions" class="hash-link" aria-label="Direct link to Restrictions" title="Direct link to Restrictions">â€‹</a></h3>
<p><strong>Order Size</strong>:</p>
<ul>
<li>No minimum order size requirement</li>
<li>No lot size restrictions - any decimal amount supported</li>
<li>Orders must have non-zero size</li>
</ul>
<p><strong>Order Limits</strong>:</p>
<ul>
<li>Maximum <strong>100 open orders</strong> per account across all sides</li>
<li>Exceeding this limit will cause the transaction to revert</li>
</ul>
<p><strong>Rate Bounds</strong>:</p>
<ul>
<li>Orders with rates significantly deviating from the mark rate will be rejected:<!-- -->
<ul>
<li><strong>Buy/Long orders</strong>: Rejected if rate is too far above the mark rate</li>
<li><strong>Sell/Short orders</strong>: Rejected if rate is too far below the mark rate</li>
</ul>
</li>
<li>The acceptable deviation threshold is market-specific and configured to prevent market manipulation</li>
</ul>
<p><strong>Bad Debt Prevention</strong>:</p>
<ul>
<li>The system continuously monitors all open orders against account health</li>
<li>Orders that could potentially put makers into bad debt if filled are force-cancelled</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="twap-oracle">TWAP Oracle<a href="#twap-oracle" class="hash-link" aria-label="Direct link to TWAP Oracle" title="Direct link to TWAP Oracle">â€‹</a></h2>
<p>Boros maintains a Time-Weighted Average Price (TWAP) oracle to calculate the <strong>mark rate</strong> - the reference rate used for margining and liquidations. Each time an order is matched against the order book. The rate of the last matched tick is incorporated into the TWAP calculation based on time elapsed.</p>
<p>The oracle uses a fixed-window observation approach:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">markRate = (lastTradedRate Ã— timeElapsed + prevOracleRate Ã— (window - timeElapsed)) / window</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/boros-dev/HighLevelArchitecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ğŸ—ï¸ High Level Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/boros-dev/Mechanics/Margin"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ğŸ’° Margin</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#order-book-structure" class="table-of-contents__link toc-highlight">Order Book Structure</a></li><li><a href="#tick-to-rate-conversion" class="table-of-contents__link toc-highlight">Tick to Rate Conversion</a><ul><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li></ul></li><li><a href="#matching-priority" class="table-of-contents__link toc-highlight">Matching Priority</a></li><li><a href="#order-id" class="table-of-contents__link toc-highlight">Order Id</a><ul><li><a href="#parsing-orderid" class="table-of-contents__link toc-highlight">Parsing OrderId</a></li></ul></li><li><a href="#placing-orders" class="table-of-contents__link toc-highlight">Placing orders</a><ul><li><a href="#time-in-force" class="table-of-contents__link toc-highlight">Time In Force</a></li><li><a href="#self-trade-prevention" class="table-of-contents__link toc-highlight">Self-trade Prevention</a></li><li><a href="#restrictions" class="table-of-contents__link toc-highlight">Restrictions</a></li></ul></li><li><a href="#twap-oracle" class="table-of-contents__link toc-highlight">TWAP Oracle</a></li></ul></div></div></div></div></div></main></div></div></div><div class="background_hm_f"><div class="root_DvgA"><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">Pages</div><a href="https://www.pendle.finance/" target="_blank">Website</a><a href="https://app.pendle.finance/market" target="_blank">App</a></div><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">Socials</div><a href="https://discord.com/invite/EAujvncY2R" target="_blank">Discord</a><a href="https://twitter.com/pendle_fi/" target="_blank">Twitter</a><a href="https://t.me/pendlefinance/" target="_blank">Telegram</a></div><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">About Us</div><a href="https://medium.com/pendle/" target="_blank">Medium</a><a href="https://angel.co/company/pendle_finance/" target="_blank">Careers</a><a href="https://pendle.finance/brandguide" target="_blank">Media Kit</a><a href="https://github.com/pendle-finance/pendle-core-v2-public/tree/master/audits" target="_blank">Audits</a></div></div></div></div>
</body>
</html>