<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Boros/Mechanics/OrderBook" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Central Limit Order Book | Pendle Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pendle.finance/cn/Boros/Mechanics/OrderBook"><meta data-rh="true" name="docusaurus_locale" content="cn"><meta data-rh="true" name="docsearch:language" content="cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Central Limit Order Book | Pendle Documentation"><meta data-rh="true" name="description" content="Boros implements a gas-optimized central limit order book (CLOB) specifically designed for the EVM. The order book architecture minimizes gas costs through lazy settlement and efficient data structures while maintaining the functionality expected from professional trading platforms."><meta data-rh="true" property="og:description" content="Boros implements a gas-optimized central limit order book (CLOB) specifically designed for the EVM. The order book architecture minimizes gas costs through lazy settlement and efficient data structures while maintaining the functionality expected from professional trading platforms."><link data-rh="true" rel="icon" href="/cn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pendle.finance/cn/Boros/Mechanics/OrderBook"><link data-rh="true" rel="alternate" href="https://pendle.finance/Boros/Mechanics/OrderBook" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://pendle.finance/cn/Boros/Mechanics/OrderBook" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pendle.finance/Boros/Mechanics/OrderBook" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GFVY0GOMCR-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6ZBS49V0YS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-6ZBS49V0YS",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Pendle Documentation" href="/cn/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/cn/assets/css/styles.98172e72.css">
<link rel="preload" href="/cn/assets/js/runtime~main.41479294.js" as="script">
<link rel="preload" href="/cn/assets/js/main.ef96af71.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div style="display:flex;flex-direction:column;align-items:center"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHidden_nLSi"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文（中国)</a><ul class="dropdown__menu"><li><a href="/Boros/Mechanics/OrderBook" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">English</a></li><li><a href="/cn/Boros/Mechanics/OrderBook" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">中文（中国)</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_W2AM"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage_qMb8"><main class="docMainContainer_RiV8 docMainContainerEnhanced_u7bj"><div class="container padding-top--md padding-bottom--lg"><div style="margin-top:2rem;max-width:900px;min-height:70vh"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Central Limit Order Book</h1><p>Boros implements a gas-optimized central limit order book (CLOB) specifically designed for the EVM. The order book architecture minimizes gas costs through <a href="/cn/Boros/Mechanics/Settlement">lazy settlement</a> and efficient data structures while maintaining the functionality expected from professional trading platforms.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="order-book-structure">Order Book Structure<a href="#order-book-structure" class="hash-link" aria-label="Direct link to Order Book Structure" title="Direct link to Order Book Structure">​</a></h2><p>The order book consists of two independent sides:</p><ul><li><strong>Long Side (Bids)</strong>: Orders to buy/go long on interest rates</li><li><strong>Short Side (Asks)</strong>: Orders to sell/go short on interest rates</li></ul><p>Each side contains <strong>65,536 discrete rate levels</strong> (ticks) ranging from -32768 to 32767.</p><p>The tick system uses an exponential function to map discrete tick indices to interest rates. This design provides:</p><ul><li><strong>Compactness</strong>: Entire rate range expressed with just 16 bits</li><li><strong>Expressiveness</strong>: Finer granularity near zero, coarser at extremes</li><li><strong>Symmetry</strong>: Equal precision for positive and negative rates</li></ul><p>The tick spacing is configurable per market via the <code>tickStep</code> parameter. A larger <code>tickStep</code> creates wider rate intervals between ticks, suitable for more volatile markets.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tick-to-rate-conversion">Tick to Rate Conversion<a href="#tick-to-rate-conversion" class="hash-link" aria-label="Direct link to Tick to Rate Conversion" title="Direct link to Tick to Rate Conversion">​</a></h2><p>The conversion between tick indices and interest rates follows an exponential formula:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>rate</mtext><mo stretchy="false">(</mo><mtext>tick</mtext><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1.0000</mn><msup><mn>5</mn><mrow><mtext>tick</mtext><mo>×</mo><mtext>tickStep</mtext></mrow></msup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if tick</mtext><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mo stretchy="false">(</mo><mn>1.0000</mn><msup><mn>5</mn><mrow><mo>−</mo><mtext>tick</mtext><mo>×</mo><mtext>tickStep</mtext></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if tick</mtext><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{rate}(\text{tick}) = \begin{cases} 1.00005^{\text{tick} \times \text{tickStep}} - 1 &amp; \text{if tick} \geq 0 \\ -(1.00005^{-\text{tick} \times \text{tickStep}} - 1) &amp; \text{if tick} &lt; 0 \end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">rate</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">tick</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">1</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">tick</span></span><span class="mbin mtight">×</span><span class="mord text mtight"><span class="mord mtight">tickStep</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord">1</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord">−</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord text mtight"><span class="mord mtight">tick</span></span><span class="mbin mtight">×</span><span class="mord text mtight"><span class="mord mtight">tickStep</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord text"><span class="mord">if tick</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mord">0</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord text"><span class="mord">if tick</span></span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><p>The TickMath library provides conversion between tick indices and interest rates:</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Convert tick to interest rate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(130, 170, 255)">int128</span><span class="token plain"> rate </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> TickMath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">getRateAtTick</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">tick</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> tickStep</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Formula: rate = 1.00005^(tick * tickStep) - 1 for tick &gt;= 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//          rate = -(1.00005^(-tick * tickStep) - 1) for tick &lt; 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// tickStep = 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tick = 0    -&gt; rate = 0% (neutral)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tick = 100  -&gt; rate =   1.00005^200 - 1  ≈  1.005%</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">tick = -100 -&gt; rate = -(1.00005^200 - 1) ≈ -1.005%</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="matching-priority">Matching Priority<a href="#matching-priority" class="hash-link" aria-label="Direct link to Matching Priority" title="Direct link to Matching Priority">​</a></h2><p>Boros order book follows the standard <strong>rate-time priority</strong> matching:</p><ul><li>Orders offering better rates are matched first<ul><li>For long orders: Higher rates (willing to pay more) have priority</li><li>For short orders: Lower rates (willing to receive less) have priority</li></ul></li><li>Within the same rate level (tick), orders are matched in the order they were placed (FIFO)<ul><li>The <code>orderIndex</code> within each tick determines the exact queue position</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="order-id">Order Id<a href="#order-id" class="hash-link" aria-label="Direct link to Order Id" title="Direct link to Order Id">​</a></h2><p>Each order in Boros has a unique order Id, which a 64-bit packed value containing order metadata:</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">OrderId structure </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> bits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">┌─────────┬──────────┬─────────────┬──────────────┐</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│ </span><span class="token function" style="color:rgb(130, 170, 255)">Init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> │ </span><span class="token function" style="color:rgb(130, 170, 255)">Side</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  │ </span><span class="token function" style="color:rgb(130, 170, 255)">Tick</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">    │ </span><span class="token function" style="color:rgb(130, 170, 255)">Index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">40</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">    │</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└─────────┴──────────┴─────────────┴──────────────┘</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bit </span><span class="token number" style="color:rgb(247, 140, 108)">63</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Initialization marker </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">always </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> valid orders</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bit </span><span class="token number" style="color:rgb(247, 140, 108)">56</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Side </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LONG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> SHORT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bits </span><span class="token number" style="color:rgb(247, 140, 108)">40</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">55</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Encoded tick index</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bits </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">39</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Order index within tick</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This encoding has a nice ordering property: orders with <strong>lower OrderId values</strong> have <strong>higher priority</strong> in the order book.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="parsing-orderid">Parsing OrderId<a href="#parsing-orderid" class="hash-link" aria-label="Direct link to Parsing OrderId" title="Direct link to Parsing OrderId">​</a></h3><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Parsing an OrderId</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">Side side</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int16</span><span class="token plain"> tickIndex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">uint40</span><span class="token plain"> orderIndex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> OrderIdLib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">unpack</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">orderId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Quick access methods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Side side </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> orderId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">side</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(130, 170, 255)">int16</span><span class="token plain"> tick </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> orderId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">tickIndex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(130, 170, 255)">uint40</span><span class="token plain"> index </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> orderId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">orderIndex</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="placing-orders">Placing orders<a href="#placing-orders" class="hash-link" aria-label="Direct link to Placing orders" title="Direct link to Placing orders">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="time-in-force">Time In Force<a href="#time-in-force" class="hash-link" aria-label="Direct link to Time In Force" title="Direct link to Time In Force">​</a></h3><p>Time In Force (TIF) parameters control how orders behave during matching and placement. Boros supports five TIF types to accommodate different trading strategies:</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">enum</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">TimeInForce</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    GTC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Good Till Cancel - Standard limit order, remains on book until filled/cancelled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    IOC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Immediate or Cancel - Executes against available liquidity, cancels unfilled portion</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FOK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Fill or Kill - Must fill entire size or transaction reverts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ALO</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">       </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Add Liquidity Only - Post-only order, transaction reverts if would match</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    SOFT_ALO   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Soft ALO - If order would match, it gets skipped (not placed on orderbook) and transaction doesn&#x27;t revert</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="self-trade-prevention">Self-trade Prevention<a href="#self-trade-prevention" class="hash-link" aria-label="Direct link to Self-trade Prevention" title="Direct link to Self-trade Prevention">​</a></h3><p>Boros prevents self-trading by checking if an incoming order would match against the same account&#x27;s existing orders. If self-matching is detected, the transaction will revert to protect traders from unintentionally trading with themselves.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restrictions">Restrictions<a href="#restrictions" class="hash-link" aria-label="Direct link to Restrictions" title="Direct link to Restrictions">​</a></h3><p><strong>Order Size</strong>:</p><ul><li>No minimum order size requirement</li><li>No lot size restrictions - any decimal amount supported</li><li>Orders must have non-zero size</li></ul><p><strong>Order Limits</strong>:</p><ul><li>Maximum <strong>100 open orders</strong> per account across all sides</li><li>Exceeding this limit will cause the transaction to revert</li></ul><p><strong>Rate Bounds</strong>:</p><ul><li>Orders with rates significantly deviating from the mark rate will be rejected:<ul><li><strong>Buy/Long orders</strong>: Rejected if rate is too far above the mark rate</li><li><strong>Sell/Short orders</strong>: Rejected if rate is too far below the mark rate</li></ul></li><li>The acceptable deviation threshold is market-specific and configured to prevent market manipulation</li></ul><p><strong>Bad Debt Prevention</strong>:</p><ul><li>The system continuously monitors all open orders against account health</li><li>Orders that could potentially put makers into bad debt if filled are force-cancelled</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="twap-oracle">TWAP Oracle<a href="#twap-oracle" class="hash-link" aria-label="Direct link to TWAP Oracle" title="Direct link to TWAP Oracle">​</a></h2><p>Boros maintains a Time-Weighted Average Price (TWAP) oracle to calculate the <strong>mark rate</strong> - the reference rate used for margining and liquidations. Each time an order is matched against the order book. The rate of the last matched tick is incorporated into the TWAP calculation based on time elapsed.</p><p>The oracle uses a fixed-window observation approach:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">markRate = (lastTradedRate × timeElapsed + prevOracleRate × (window - timeElapsed)) / window</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#order-book-structure" class="table-of-contents__link toc-highlight">Order Book Structure</a></li><li><a href="#tick-to-rate-conversion" class="table-of-contents__link toc-highlight">Tick to Rate Conversion</a><ul><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li></ul></li><li><a href="#matching-priority" class="table-of-contents__link toc-highlight">Matching Priority</a></li><li><a href="#order-id" class="table-of-contents__link toc-highlight">Order Id</a><ul><li><a href="#parsing-orderid" class="table-of-contents__link toc-highlight">Parsing OrderId</a></li></ul></li><li><a href="#placing-orders" class="table-of-contents__link toc-highlight">Placing orders</a><ul><li><a href="#time-in-force" class="table-of-contents__link toc-highlight">Time In Force</a></li><li><a href="#self-trade-prevention" class="table-of-contents__link toc-highlight">Self-trade Prevention</a></li><li><a href="#restrictions" class="table-of-contents__link toc-highlight">Restrictions</a></li></ul></li><li><a href="#twap-oracle" class="table-of-contents__link toc-highlight">TWAP Oracle</a></li></ul></div></div></div></div></div></main></div></div><div class="background_hm_f"><div class="root_DvgA"><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">Pages</div><a href="https://www.pendle.finance/" target="_blank">Website</a><a href="https://app.pendle.finance/market" target="_blank">App</a></div><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">Socials</div><a href="https://discord.com/invite/EAujvncY2R" target="_blank">Discord</a><a href="https://twitter.com/pendle_fi/" target="_blank">Twitter</a><a href="https://t.me/pendlefinance/" target="_blank">Telegram</a></div><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">About Us</div><a href="https://medium.com/pendle/" target="_blank">Medium</a><a href="https://angel.co/company/pendle_finance/" target="_blank">Careers</a><a href="https://pendle.finance/brandguide" target="_blank">Media Kit</a><a href="https://github.com/pendle-finance/pendle-core-v2-public/tree/master/audits" target="_blank">Audits</a></div></div></div></div></div>
<script src="/cn/assets/js/runtime~main.41479294.js"></script>
<script src="/cn/assets/js/main.ef96af71.js"></script>
</body>
</html>