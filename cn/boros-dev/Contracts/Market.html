<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-boros-dev docs-version-current docs-doc-page docs-doc-id-Contracts/Market" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Market View Functions | Pendle Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://pendle.finance/cn/boros-dev/Contracts/Market"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en_US"><meta data-rh="true" name="docusaurus_locale" content="cn"><meta data-rh="true" name="docsearch:language" content="cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-boros-dev-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-boros-dev-current"><meta data-rh="true" property="og:title" content="Market View Functions | Pendle Documentation"><meta data-rh="true" name="description" content="The Market contract provides comprehensive view functions for querying market state, user positions, order book data, and risk parameters."><meta data-rh="true" property="og:description" content="The Market contract provides comprehensive view functions for querying market state, user positions, order book data, and risk parameters."><link data-rh="true" rel="icon" href="/cn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pendle.finance/cn/boros-dev/Contracts/Market"><link data-rh="true" rel="alternate" href="https://pendle.finance/boros-dev/Contracts/Market" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://pendle.finance/cn/boros-dev/Contracts/Market" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pendle.finance/boros-dev/Contracts/Market" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://GFVY0GOMCR-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"📈 Market","item":"https://pendle.finance/cn/boros-dev/Contracts/Market"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6ZBS49V0YS"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-6ZBS49V0YS",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Pendle Documentation" href="/cn/opensearch.xml">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><link rel="stylesheet" href="/cn/assets/css/styles.d8610ff0.css">
<script src="/cn/assets/js/runtime~main.45c9f321.js" defer="defer"></script>
<script src="/cn/assets/js/main.cfdff5d8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12h18m-9-9h9m-9 18h9"></path></svg></button><a href="/cn/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Pendle"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Pendle V2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/cn/pendle-v2/Introduction">Pendle V2 Docs</a></li><li><a href="https://pendle.gitbook.io/pendle-academy/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Pendle Academy<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Boros</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cn/boros-dev">Boros Dev Docs</a></li><li><a href="https://pendle.gitbook.io/boros/boros-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Boros Docs<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://pendle.gitbook.io/boros" target="_blank" rel="noopener noreferrer" class="dropdown__link">Boros Academy<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="searchContainer_eKWQ"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button><div class="language-switcher" style="display:flex;align-items:center;margin-left:12px"><select style="background:rgba(248, 250, 252, 0.8);border:1px solid rgba(15, 23, 42, 0.1);border-radius:8px;padding:6px 12px;font-size:14px;color:#475569;cursor:pointer;min-width:80px"><option value="en">English</option><option value="cn" selected="">中文（中国)</option></select></div></div></div></div><div class="scrollProgressLine_ACL0"></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_cWv0"><aside class="theme-doc-sidebar-container docSidebarContainer_RSuS"><div class="sidebar_mhZE"><nav class="menu thin-scrollbar menu_Y1UP"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/boros-dev">📖 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/boros-dev/LitePaper">📄 Lite Paper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/boros-dev/HighLevelArchitecture">🏗️ High Level Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cn/boros-dev/Mechanics/OrderBook">⚙️ Mechanics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/cn/boros-dev/Contracts/Router">📜 Contracts</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/boros-dev/Contracts/Router">🔀 Router</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/boros-dev/Contracts/MarketHub">🏪 MarketHub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cn/boros-dev/Contracts/Market">📈 Market</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cn/boros-dev/Contracts/CustomTypes">🎨 Custom Types</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cn/boros-dev/Backend/REST API">🔌 Backend Integration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cn/boros-dev/FAQ">❓ FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_hjYf"><div class="container padding-top--md padding-bottom--lg"><div><div class="row"><div class="col"><div><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">📜 Contracts</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">📈 Market</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Market View Functions</h1></header>
<p>The Market contract provides comprehensive view functions for querying market state, user positions, order book data, and risk parameters.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="market-information">Market Information<a href="#market-information" class="hash-link" aria-label="Direct link to Market Information" title="Direct link to Market Information">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="descriptor"><code>descriptor()</code><a href="#descriptor" class="hash-link" aria-label="Direct link to descriptor" title="Direct link to descriptor">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bool isIsolatedOnly,     // True if market only supports isolated margin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    TokenId tokenId,         // Underlying collateral token ID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MarketId marketId,       // Unique market identifier</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint32 maturity,         // Maturity timestamp</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint8 tickStep,          // Tick step for calculating tick rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint16 iTickThresh,      // Tick threshold for margin calculation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint32 latestFTime       // Latest fTime</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">) = market.descriptor();</span><br></span></code></pre></div></div>
<p>The rate threshold for margin calculations can be derived from <code>tickStep</code> and <code>iTickThresh</code>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">int256 rateThreshold = TickMath.getRateAtTick(iTickThresh, tickStep);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="name-and-symbol"><code>name()</code> and <code>symbol()</code><a href="#name-and-symbol" class="hash-link" aria-label="Direct link to name-and-symbol" title="Direct link to name-and-symbol">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">string memory marketName = market.name();     // e.g., &quot;Binance ETHUSDT 26 Sep 2025&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">string memory marketSymbol = market.symbol(); // e.g., &quot;BINANCE-ETHUSDT-26SEP2025&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getoi"><code>getOI()</code><a href="#getoi" class="hash-link" aria-label="Direct link to getoi" title="Direct link to getoi">​</a></h3>
<p>Returns the total open interest across both long and short positions. Note that this represents the sum of absolute position sizes from both sides, which differs from conventional open interest calculations that typically report only one side.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">uint256 openInterest = market.getOI();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(&quot;Total open interest: %s&quot;, openInterest);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getmarketconfig"><code>getMarketConfig()</code><a href="#getmarketconfig" class="hash-link" aria-label="Direct link to getmarketconfig" title="Direct link to getmarketconfig">​</a></h3>
<p>Returns the complete market configuration parameters:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">struct MarketConfigStruct {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint16 maxOpenOrders;                    // Maximum orders per account</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address markRateOracle;                  // Oracle for mark rate calculation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    address fIndexOracle;                    // Oracle for floating index updates</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint128 hardOICap;                       // Hard open interest cap</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint64 takerFee;                         // Taker fee rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint64 otcFee;                           // OTC swap fee rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    LiqSettings liqSettings;                 // Liquidation incentive parameters</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint64 kIM;                              // Initial margin factor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint64 kMM;                              // Maintenance margin factor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint32 tThresh;                          // Time threshold for margin calculations</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint16 maxRateDeviationFactorBase1e4;    // Max rate deviation from mark rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint16 closingOrderBoundBase1e4;         // Rate bounds for closing orders</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int16 loUpperConstBase1e4;               // Limit order upper constant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int16 loUpperSlopeBase1e4;               // Limit order upper slope</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int16 loLowerConstBase1e4;               // Limit order lower constant</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int16 loLowerSlopeBase1e4;               // Limit order lower slope</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MarketStatus status;                     // Market status (PAUSED/CLO/GOOD)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bool useImpliedAsMarkRate;               // Whether to use implied rate as mark rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MarketConfigStruct memory config = market.getMarketConfig();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(&quot;Max open orders: %s&quot;, config.maxOpenOrders);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(&quot;Taker fee: %s bps&quot;, config.takerFee);</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="order-book">Order Book<a href="#order-book" class="hash-link" aria-label="Direct link to Order Book" title="Direct link to Order Book">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getnextnticks"><code>getNextNTicks()</code><a href="#getnextnticks" class="hash-link" aria-label="Direct link to getnextnticks" title="Direct link to getnextnticks">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Get best 10 LONG ticks</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(int16[] memory ticks, uint256[] memory sizes) = market.getNextNTicks(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Side.LONG,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Side.LONG.tickToGetFirstAvail(),</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    10</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Get liquidity after specific tick</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int16 bestAskTick = 125;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(int16[] memory nextTicks, uint256[] memory nextSizes) = market.getNextNTicks(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Side.SHORT,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    bestAskTick,   // Start after this tick</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getallopenorders"><code>getAllOpenOrders()</code><a href="#getallopenorders" class="hash-link" aria-label="Direct link to getallopenorders" title="Direct link to getallopenorders">​</a></h3>
<p>Returns all open orders for a user account. Each order contains:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">struct Order {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    OrderStatus status;  // NOT_EXIST, OPEN, PENDING_SETTLE, PURGED</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    OrderId id;          // Unique 64-bit identifier encoding side, tick, and index</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MarketAcc maker;     // Account that placed the order</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint256 size;        // Order size (18 decimals)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int256 rate;         // Order rate derived from tick index</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MarketAcc userAccount = AccountLib.toMainCross(userAddress, tokenId);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Order[] memory orders = market.getAllOpenOrders(userAccount);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">for (uint i = 0; i &lt; orders.length; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Order memory order = orders[i];</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.log(&quot;Order ID: %s&quot;, OrderId.unwrap(order.id));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.log(&quot;Size: %s&quot;, order.size);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.log(&quot;Rate: %s&quot;, order.rate);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    console.log(&quot;Status: %s&quot;, uint(order.status));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getorder"><code>getOrder()</code><a href="#getorder" class="hash-link" aria-label="Direct link to getorder" title="Direct link to getorder">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">OrderId orderId = OrderIdLib.from(Side.LONG, 125, 1000);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Order memory order = market.getOrder(orderId);</span><br></span></code></pre></div></div>
<p><strong>Caveats:</strong></p>
<ul>
<li>For order that is <strong>not fully filled</strong>, <code>size</code> returns the <strong>remaining unfilled size</strong>, not the original order size.</li>
<li>If an order is partially filled (possible multiple times) before being fully filled, <code>size</code> returns the remaining order size right before the order gets fully filled, excluding previous partial fills.</li>
<li>Cancelled orders show <code>status = NOT_EXIST</code> and <code>size = 0</code>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="position-and-risk">Position and Risk<a href="#position-and-risk" class="hash-link" aria-label="Direct link to Position and Risk" title="Direct link to Position and Risk">​</a></h2>
<p>Functions ending with <code>NoSettle</code> return potentially outdated data without triggering settlement. Due to Boros&#x27;s lazy settlement system, on-chain state may not reflect the latest position values until the next user interaction.</p>
<p><strong>Important:</strong> For accurate, up-to-date position data, first trigger <a href="/cn/boros-dev/Mechanics/Settlement">settlement</a>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">IMarketHub(marketHub).settleAllAndGet(userAccount, GetRequest.ZERO, MarketId.ZERO);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getsignedsizenosettle"><code>getSignedSizeNoSettle()</code><a href="#getsignedsizenosettle" class="hash-link" aria-label="Direct link to getsignedsizenosettle" title="Direct link to getsignedsizenosettle">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MarketAcc userAccount = AccountLib.toCross(mainAccount, tokenId);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int256 position = market.getSignedSizeNoSettle(userAccount);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="calcpositionvaluenosettle"><code>calcPositionValueNoSettle()</code><a href="#calcpositionvaluenosettle" class="hash-link" aria-label="Direct link to calcpositionvaluenosettle" title="Direct link to calcpositionvaluenosettle">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">int256 positionValue = market.calcPositionValueNoSettle(userAccount);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="calcmarginnosettle"><code>calcMarginNoSettle()</code><a href="#calcmarginnosettle" class="hash-link" aria-label="Direct link to calcmarginnosettle" title="Direct link to calcmarginnosettle">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Calculate initial margin requirement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">uint256 initialMargin = market.calcMarginNoSettle(userAccount, MarginType.IM);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// Calculate maintenance margin requirement</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">uint256 maintenanceMargin = market.calcMarginNoSettle(userAccount, MarginType.MM);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getmarginfactor"><code>getMarginFactor()</code><a href="#getmarginfactor" class="hash-link" aria-label="Direct link to getmarginfactor" title="Direct link to getmarginfactor">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">(uint64 kIM, uint64 kMM) = market.getMarginFactor(userAccount);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getpendingsizes"><code>getPendingSizes()</code><a href="#getpendingsizes" class="hash-link" aria-label="Direct link to getpendingsizes" title="Direct link to getpendingsizes">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">(uint256 pendingLong, uint256 pendingShort) = market.getPendingSizes(userAccount);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(&quot;Pending long orders: %s&quot;, pendingLong);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">console.log(&quot;Pending short orders: %s&quot;, pendingShort);</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="funding-and-settlement-tracking">Funding and Settlement Tracking<a href="#funding-and-settlement-tracking" class="hash-link" aria-label="Direct link to Funding and Settlement Tracking" title="Direct link to Funding and Settlement Tracking">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getlatestfindex"><code>getLatestFIndex()</code><a href="#getlatestfindex" class="hash-link" aria-label="Direct link to getlatestfindex" title="Direct link to getlatestfindex">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">FIndex latestIndex = market.getLatestFIndex();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">uint32 fTime = latestIndex.fTime();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">int112 floatingIndex = latestIndex.floatingIndex();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">uint64 feeIndex = latestIndex.feeIndex();</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rate-information">Rate Information<a href="#rate-information" class="hash-link" aria-label="Direct link to Rate Information" title="Direct link to Rate Information">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getimpliedrate"><code>getImpliedRate()</code><a href="#getimpliedrate" class="hash-link" aria-label="Direct link to getimpliedrate" title="Direct link to getimpliedrate">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int128 lastTradedRate,      // Last trade execution rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    int128 oracleRate,          // TWAP rate</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint32 lastTradedTime,      // Timestamp of last trade</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    uint32 observationWindow    // Rate observation window</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">) = market.getImpliedRate();</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getmarkrateview"><code>getMarkRateView()</code><a href="#getmarkrateview" class="hash-link" aria-label="Direct link to getmarkrateview" title="Direct link to getmarkrateview">​</a></h3>
<p>Returns the current mark rate used for margin calculations and position valuation. This is the oracle-based TWAP rate from the order book&#x27;s rate observations.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">int256 markRate = market.getMarkRateView();</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fees">Fees<a href="#fees" class="hash-link" aria-label="Direct link to Fees" title="Direct link to Fees">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getbestfeerates"><code>getBestFeeRates()</code><a href="#getbestfeerates" class="hash-link" aria-label="Direct link to getbestfeerates" title="Direct link to getbestfeerates">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MarketAcc user = AccountLib.toMainCross(userAddress, tokenId);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">MarketAcc counterparty = AccountLib.toMainCross(counterpartyAddress, tokenId);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">(uint64 takerFee, uint64 otcFee) = market.getBestFeeRates(user, counterparty);</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/cn/boros-dev/Contracts/MarketHub"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">🏪 MarketHub</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cn/boros-dev/Contracts/CustomTypes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">🎨 Custom Types</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#market-information" class="table-of-contents__link toc-highlight">Market Information</a><ul><li><a href="#descriptor" class="table-of-contents__link toc-highlight"><code>descriptor()</code></a></li><li><a href="#name-and-symbol" class="table-of-contents__link toc-highlight"><code>name()</code> and <code>symbol()</code></a></li><li><a href="#getoi" class="table-of-contents__link toc-highlight"><code>getOI()</code></a></li><li><a href="#getmarketconfig" class="table-of-contents__link toc-highlight"><code>getMarketConfig()</code></a></li></ul></li><li><a href="#order-book" class="table-of-contents__link toc-highlight">Order Book</a><ul><li><a href="#getnextnticks" class="table-of-contents__link toc-highlight"><code>getNextNTicks()</code></a></li><li><a href="#getallopenorders" class="table-of-contents__link toc-highlight"><code>getAllOpenOrders()</code></a></li><li><a href="#getorder" class="table-of-contents__link toc-highlight"><code>getOrder()</code></a></li></ul></li><li><a href="#position-and-risk" class="table-of-contents__link toc-highlight">Position and Risk</a><ul><li><a href="#getsignedsizenosettle" class="table-of-contents__link toc-highlight"><code>getSignedSizeNoSettle()</code></a></li><li><a href="#calcpositionvaluenosettle" class="table-of-contents__link toc-highlight"><code>calcPositionValueNoSettle()</code></a></li><li><a href="#calcmarginnosettle" class="table-of-contents__link toc-highlight"><code>calcMarginNoSettle()</code></a></li><li><a href="#getmarginfactor" class="table-of-contents__link toc-highlight"><code>getMarginFactor()</code></a></li><li><a href="#getpendingsizes" class="table-of-contents__link toc-highlight"><code>getPendingSizes()</code></a></li></ul></li><li><a href="#funding-and-settlement-tracking" class="table-of-contents__link toc-highlight">Funding and Settlement Tracking</a><ul><li><a href="#getlatestfindex" class="table-of-contents__link toc-highlight"><code>getLatestFIndex()</code></a></li></ul></li><li><a href="#rate-information" class="table-of-contents__link toc-highlight">Rate Information</a><ul><li><a href="#getimpliedrate" class="table-of-contents__link toc-highlight"><code>getImpliedRate()</code></a></li><li><a href="#getmarkrateview" class="table-of-contents__link toc-highlight"><code>getMarkRateView()</code></a></li></ul></li><li><a href="#fees" class="table-of-contents__link toc-highlight">Fees</a><ul><li><a href="#getbestfeerates" class="table-of-contents__link toc-highlight"><code>getBestFeeRates()</code></a></li></ul></li></ul></div></div></div></div></div></main></div></div></div><div class="background_hm_f"><div class="root_DvgA"><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">Pages</div><a href="https://www.pendle.finance/" target="_blank">Website</a><a href="https://app.pendle.finance/market" target="_blank">App</a></div><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">Socials</div><a href="https://discord.com/invite/EAujvncY2R" target="_blank">Discord</a><a href="https://twitter.com/pendle_fi/" target="_blank">Twitter</a><a href="https://t.me/pendlefinance/" target="_blank">Telegram</a></div><div class="linkGroup_Ckfr"><div class="linkGroupTitle_rRS_">About Us</div><a href="https://medium.com/pendle/" target="_blank">Medium</a><a href="https://angel.co/company/pendle_finance/" target="_blank">Careers</a><a href="https://pendle.finance/brandguide" target="_blank">Media Kit</a><a href="https://github.com/pendle-finance/pendle-core-v2-public/tree/master/audits" target="_blank">Audits</a></div></div></div></div>
</body>
</html>