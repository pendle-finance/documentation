"use strict";(self.webpackChunkpendle_documentation=self.webpackChunkpendle_documentation||[]).push([[7110],{6142:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Developers/Contracts/PendleRouter/PendleRouterOverview","title":"Pendle Router Overview","description":"Quick Start","source":"@site/docs/pendle-v2/Developers/Contracts/PendleRouter/PendleRouterOverview.md","sourceDirName":"Developers/Contracts/PendleRouter","slug":"/Developers/Contracts/PendleRouter/PendleRouterOverview","permalink":"/cn/pendle-v2/Developers/Contracts/PendleRouter/PendleRouterOverview","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"hide_table_of_contents":true},"sidebar":"myAutogeneratedSidebar","previous":{"title":"PendleMarket","permalink":"/cn/pendle-v2/Developers/Contracts/PendleMarket"},"next":{"title":"Pendle Router Contract Integration Guide","permalink":"/cn/pendle-v2/Developers/Contracts/PendleRouter/ContractIntegrationGuide"}}');var r=t(4848),o=t(8453);const s={hide_table_of_contents:!0},l="Pendle Router Overview",a={},d=[{value:"Quick Start",id:"quick-start",level:2},{value:"Overview",id:"overview",level:2},{value:"Integration Guide",id:"integration-guide",level:2},{value:"Method 1: Using the Pendle Hosted SDK (Recommended)",id:"method-1-using-the-pendle-hosted-sdk-recommended",level:3},{value:"Method 2: Direct Interaction with the Pendle Router",id:"method-2-direct-interaction-with-the-pendle-router",level:3},{value:"Available Router Functions",id:"available-router-functions",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"pendle-router-overview",children:"Pendle Router Overview"})}),"\n",(0,r.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["To see examples of how to use Pendle Router, checkout ",(0,r.jsx)(n.a,{href:"#integration-guide",children:"Integration Guide"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"PendleRouter is a contract that aggregates callers' actions with various different SYs, PTs, YTs, and markets. It does not have any special permissions or whitelists on any contracts it interacts with. However, it is recommended that third parties use the Router to enjoy the fee discount while trading with the pool, as opposed to directly interacting with the pools themselves. The lnFeeRateRoot in the pool will be reduced when the Router is used to trade."}),"\n",(0,r.jsx)(n.p,{children:"Up until now, the Router has had four versions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RouterV1"}),", deployed on 23/11/2022 at ",(0,r.jsx)(n.code,{children:"0x41FAD93F225b5C1C95f2445A5d7fcB85bA46713f"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RouterV2"}),", deployed on 21/02/2023 at ",(0,r.jsx)(n.code,{children:"0x0000000001e4ef00d069e71d6ba041b0a16f7ea0"}),", 15% to 20% more gas-optimized"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RouterV3"}),", deployed on 18/12/2023 at ",(0,r.jsx)(n.code,{children:"0x00000000005BBB0EF59571E58418F9a4357b68A0"}),", supporting limit orders"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RouterV4"}),", deployed on 29/04/2024 at ",(0,r.jsx)(n.code,{children:"0x888888888889758F76e7103c6CbF23ABbF58F946"}),", upgradable router to support new features and optimize the algorithm more easily without requiring partners to migrate. This is likely the last version of the Router with features being added gradually."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Since PendleRouter is a proxy to multiple implementations (using the ",(0,r.jsx)(n.a,{href:"https://eips.ethereum.org/EIPS/eip-2535",children:"EIP-2535 Diamond Standard"}),"), the caller can call the desired functions, and the Router will resolve to the correct implementation. Please refer to the ",(0,r.jsx)(n.a,{href:"https://github.com/pendle-finance/pendle-core-v2-public/blob/main/contracts/interfaces/IPAllActionV3.sol",children:"list of callable functions"}),"."]}),"\n",(0,r.jsx)(n.admonition,{title:"Block Explorer Limitation",type:"caution",children:(0,r.jsxs)(n.p,{children:["Because the Router uses the Diamond proxy pattern, block explorers like Etherscan ",(0,r.jsx)(n.strong,{children:"cannot correctly display all available functions"}),". They typically only show the ABI of the base proxy contract, not the aggregated functions from all its facets (implementations). To interact with the full range of Router functions, use the complete combined ABI from ",(0,r.jsx)(n.a,{href:"https://github.com/pendle-finance/pendle-core-v2-public/blob/main/contracts/interfaces/IPAllActionV3.sol",children:(0,r.jsx)(n.code,{children:"IPAllActionV3.sol"})}),"."]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Important notes on older Router versions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RouterV2"})," may have issues with newer markets where a necessary approval step is not being called. On some networks like Mantle, RouterV2 is not supported and will revert."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RouterV3"})," and earlier versions remain functional but lack the latest optimizations. Upgrading to ",(0,r.jsx)(n.strong,{children:"RouterV4"})," is highly recommended for all integrations."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For a comprehensive understanding of the Pendle ecosystem, including key concepts and terminology, please refer to the ",(0,r.jsx)(n.a,{href:"../../HighLevelArchitecture",children:"High Level Architecture"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"integration-guide",children:"Integration Guide"}),"\n",(0,r.jsx)(n.p,{children:"This section covers how to interact with the Pendle Router to buy and sell Principal Tokens (PTs) and Yield Tokens (YTs) using two methods:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pendle's Hosted SDK"}),": Recommended for optimized liquidity, gas efficiency, and broader token support. Hosted SDK is publicly available at ",(0,r.jsx)(n.a,{href:"https://api-v2.pendle.finance/core/docs",children:"https://api-v2.pendle.finance/core/docs"}),". More about it at ",(0,r.jsx)(n.a,{href:"/cn/pendle-v2/Developers/Backend/HostedSdk",children:"Pendle Hosted SDK"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Direct Interaction with the Pendle Router"}),": Offers direct contract interaction, all data are generate onchain."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"We highly recommend using Pendle's SDK to generate calldata for several reasons:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Gas Efficiency"}),": Currently, Pendle's AMM only supports the built-in ",(0,r.jsx)(n.code,{children:"swapExactPtForSy"})," and ",(0,r.jsx)(n.code,{children:"swapSyForExactPt"}),". To execute a ",(0,r.jsx)(n.code,{children:"swapExactTokenForPt"})," (which is essentially the same as ",(0,r.jsx)(n.code,{children:"swapExactSyForPt"}),"), the router will conduct a binary search to determine the amount of PT to swap. While the binary search can be done entirely on-chain, limiting the search range off-chain will result in significantly less gas consumption for this function. The SDK leverages off-chain data to optimize gas usage, potentially reducing gas costs significantly."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Accurate Price Impacts"}),": The SDK provides precise calculations for swaps, ensuring better price impacts for users."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Limit Order System"}),": The limit order system of Pendle exists solely off-chain. Including these limit orders in on-chain swaps can significantly improve the price impact for users, particularly during large-size swaps."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ease of Integration"}),": By using the SDK, developers can seamlessly integrate Pendle's functionality into their applications, leveraging the full power of the swap aggregator, limit order system, and off-chain data preparation."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Convenient zapping with any ERC20 token"}),": Liquidity is currently fragmented across a large number of pools across various DEXes. Integrating only Uniswap or Balancer has proven to be insufficient. As a result, PendleRouter has natively integrated ",(0,r.jsx)(n.a,{href:"https://kyberswap.com/",children:"KyberSwap"})," to swap from any ERC20 token to another. For KyberSwap to work, the routing algorithm must be called off-chain and then pass the routing results to the Router to execute."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"We'll explore both methods, including example code, for each approach."}),"\n",(0,r.jsx)(n.h3,{id:"method-1-using-the-pendle-hosted-sdk-recommended",children:"Method 1: Using the Pendle Hosted SDK (Recommended)"}),"\n",(0,r.jsxs)(n.p,{children:["The Hosted SDK handles off-chain optimization, aggregator routing, and limit order integration automatically. See the ",(0,r.jsx)(n.a,{href:"/cn/pendle-v2/Developers/Backend/HostedSdk",children:"Hosted SDK Documentation"})," for full details, examples, and supported operations."]}),"\n",(0,r.jsx)(n.h3,{id:"method-2-direct-interaction-with-the-pendle-router",children:"Method 2: Direct Interaction with the Pendle Router"}),"\n",(0,r.jsxs)(n.p,{children:["For fully on-chain integrations without the SDK, see the ",(0,r.jsx)(n.a,{href:"./ContractIntegrationGuide",children:"Contract Integration Guide"})," for step-by-step Solidity examples covering PT/YT trading, liquidity management, and minting/redeeming."]}),"\n",(0,r.jsxs)(n.p,{children:["Key struct types used by the Router (",(0,r.jsx)(n.code,{children:"TokenInput"}),", ",(0,r.jsx)(n.code,{children:"TokenOutput"}),", ",(0,r.jsx)(n.code,{children:"ApproxParams"}),", ",(0,r.jsx)(n.code,{children:"LimitOrderData"}),") are documented in the ",(0,r.jsx)(n.a,{href:"./ApiReference/Types",children:"Types and Utility Functions"})," reference, along with helper functions for on-chain parameter generation."]}),"\n",(0,r.jsx)(n.h3,{id:"available-router-functions",children:"Available Router Functions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Trading"}),": ",(0,r.jsx)(n.code,{children:"swapExactTokenForPt"}),", ",(0,r.jsx)(n.code,{children:"swapExactPtForToken"}),", ",(0,r.jsx)(n.code,{children:"swapExactTokenForYt"}),", ",(0,r.jsx)(n.code,{children:"swapExactYtForToken"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Liquidity"}),": ",(0,r.jsx)(n.code,{children:"addLiquiditySingleToken"}),", ",(0,r.jsx)(n.code,{children:"removeLiquiditySingleToken"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Minting/Redeeming"}),": ",(0,r.jsx)(n.code,{children:"mintPyFromToken"}),", ",(0,r.jsx)(n.code,{children:"redeemPyToToken"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rewards"}),": ",(0,r.jsx)(n.code,{children:"redeemDueInterestAndRewards"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For the full list, see ",(0,r.jsx)(n.a,{href:"https://github.com/pendle-finance/pendle-core-v2-public/blob/main/contracts/interfaces/IPAllActionV3.sol",children:(0,r.jsx)(n.code,{children:"IPAllActionV3.sol"})}),". Example code: ",(0,r.jsx)(n.a,{href:"https://github.com/pendle-finance/pendle-examples-public/blob/main/test/RouterSample.sol",children:"RouterSample.sol"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var i=t(6540);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);