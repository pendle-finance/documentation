"use strict";(self.webpackChunkpendle_documentation=self.webpackChunkpendle_documentation||[]).push([[7035],{519:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>o,frontMatter:()=>l,metadata:()=>n,toc:()=>m});const n=JSON.parse('{"id":"Developers/Oracles/DeterministicOracles/LPLinearDiscountOracle","title":"LP Linear Discount Oracle","description":"Overview","source":"@site/docs/pendle-v2/Developers/Oracles/DeterministicOracles/LPLinearDiscountOracle.md","sourceDirName":"Developers/Oracles/DeterministicOracles","slug":"/Developers/Oracles/DeterministicOracles/LPLinearDiscountOracle","permalink":"/cn/pendle-v2/Developers/Oracles/DeterministicOracles/LPLinearDiscountOracle","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"hide_table_of_contents":true},"sidebar":"myAutogeneratedSidebar","previous":{"title":"Pendle Spark Linear Discount Oracle","permalink":"/cn/pendle-v2/Developers/Oracles/DeterministicOracles/LinearDiscountOracle"},"next":{"title":"Choosing Linear Discount Parameters","permalink":"/cn/pendle-v2/Developers/Oracles/DeterministicOracles/ChoosingLinearDiscountParams"}}');var i=a(4848),r=a(8453);const l={hide_table_of_contents:!0},t="LP Linear Discount Oracle",c={},m=[{value:"Overview",id:"overview",level:2},{value:"Use cases",id:"use-cases",level:2},{value:"Usage",id:"usage",level:2},{value:"Deployment",id:"deployment",level:3},{value:"Feed retrieval",id:"feed-retrieval",level:3},{value:"Feed properties",id:"feed-properties",level:4}];function d(e){const s={a:"a",annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msup:"msup",mtext:"mtext",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Details:a}=s;return a||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"lp-linear-discount-oracle",children:"LP Linear Discount Oracle"})}),"\n",(0,i.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(s.p,{children:["Similar to ",(0,i.jsx)(s.a,{href:"/cn/pendle-v2/Developers/Oracles/DeterministicOracles/LinearDiscountOracle",children:"Pendle Spark Linear Discount Oracle"}),", the ",(0,i.jsx)(s.strong,{children:"LPLinearDiscountOracle"})," provides a deterministic discount factor for Pendle Liquidity Provider (LP) tokens. This oracle is designed to help money markets and lending platforms value LP tokens that represent a share in a liquidity pool containing Pendle's LP Tokens."]}),"\n",(0,i.jsxs)(s.p,{children:["The only difference between this oracle and the standard Linear Discount Oracle is that the LP version allows setting the ",(0,i.jsx)(s.code,{children:"lpMaturedPrice"})," - the price of the LP token at maturity, while the convergence price of PT is always 1.0."]}),"\n",(0,i.jsxs)(s.p,{children:["The contract exposes familiar read functions (",(0,i.jsx)(s.code,{children:"latestRoundData"}),", ",(0,i.jsx)(s.code,{children:"decimals"}),") so money markets can plug it in like a Chainlink-compatible feed. The returned value is a ",(0,i.jsx)(s.strong,{children:"multiplier in 18 decimals"}),", not a USD price."]}),"\n",(0,i.jsxs)(s.p,{children:["Please see the ",(0,i.jsx)(s.a,{href:"/cn/pendle-v2/Developers/Oracles/DeterministicOracles/ChoosingLinearDiscountParams",children:"Choosing Linear Discount Parameters"})," documentation for guidance on selecting appropriate linear discount parameters."]}),"\n",(0,i.jsx)(s.h2,{id:"use-cases",children:"Use cases"}),"\n",(0,i.jsxs)(s.p,{children:["For money markets listing LPs as collateral or borrowable assets, the oracle provides a stable, predictable valuation path. Integrators read the factor, multiply it by their LP redemption preview (and then by the underlying'S USD price feed if needed). Because the factor converges linearly to ",(0,i.jsx)(s.code,{children:"lpMaturedPrice"})," at expiry, LTVs and liquidation thresholds behave smoothly instead of whipsawing with AMM volatility."]}),"\n",(0,i.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(s.h3,{id:"deployment",children:"Deployment"}),"\n",(0,i.jsxs)(s.p,{children:["The oracle can be deployed using the ",(0,i.jsx)(s.code,{children:"lpLinearDiscountOracleFactory"}),". The address of the factory can be found in the ",(0,i.jsx)(s.a,{href:"../../Deployments/Ethereum.md",children:"Deployments"})," sections, under the ",(0,i.jsx)(s.code,{children:'"lpLinearDiscountOracleFactory"'})," field. The factory has a method to help with oracle deployment:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sol",children:"function create(address market, uint256 basePtDiscountPerYear, uint256 lpMaturedPrice) external returns (address res);\n"})}),"\n",(0,i.jsx)(s.h3,{id:"feed-retrieval",children:"Feed retrieval"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-sol",children:"function latestRoundData()\n    external\n    view\n    returns (uint80 roundId, int256 answer, uint256 startedAt, uint256 updatedAt, uint80 answeredInRound)\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Since the oracle is deterministic, except for ",(0,i.jsx)(s.code,{children:"answer"}),", every other fields returned are ",(0,i.jsx)(s.code,{children:"0"}),"."]}),"\n",(0,i.jsx)(s.h4,{id:"feed-properties",children:"Feed properties"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Decimals"}),": The oracle returns values in 18 decimals, so integrators should multiply the factor by their LP redemption preview (also in 18 decimals) to get the value."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Deterministic"}),": The oracle is deterministic, meaning the same inputs will always yield the same output. This allows for predictable valuation paths."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Linear Discount"}),": The discount factor increases linearly over time, converging to ",(0,i.jsx)(s.code,{children:"lpMaturedPrice"})," at maturity."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"No External Calls"}),": The oracle does not make any external calls during reads, ensuring minimal liveness or manipulation surface. It relies solely on ",(0,i.jsx)(s.code,{children:"block.timestamp"})," for time calculations."]}),"\n"]}),"\n",(0,i.jsxs)(a,{children:[(0,i.jsxs)("summary",{children:["How ",(0,i.jsx)("code",{children:"answer"})," is deterministically calculated"]}),(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"answer"})," relies on two parameters:"]}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"baseDiscountPerYear"})," - the annual discount slope, expressed in wad (1e18 = 100%/year)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"maturity"})," - the LP maturity timestamp in seconds (",(0,i.jsx)(s.code,{children:"LP.expiry()"}),")."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"lpMaturedPrice"})," - the price of the LP token at maturity, expressed in wad (1e18 = 100%)."]}),"\n"]}),(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"answer"})," at a given time ",(0,i.jsx)(s.code,{children:"t"})," (in seconds) is calculated as follows:"]}),(0,i.jsx)(s.span,{className:"katex-display",children:(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mtext,{children:"answer"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.mtext,{children:"lpMaturedPrice"}),(0,i.jsx)(s.mo,{children:"\u22c5"}),(0,i.jsx)(s.mi,{children:"min"}),(0,i.jsx)(s.mo,{children:"\u2061"}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mo,{fence:"true",children:"("}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mn,{children:"10"}),(0,i.jsx)(s.mn,{children:"18"})]}),(0,i.jsx)(s.mo,{separator:"true",children:","}),(0,i.jsxs)(s.msup,{children:[(0,i.jsx)(s.mn,{children:"10"}),(0,i.jsx)(s.mn,{children:"18"})]}),(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsxs)(s.mfrac,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mtext,{children:"maturity"}),(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsx)(s.mi,{children:"t"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{children:"\u22c5"}),(0,i.jsx)(s.mtext,{children:"baseDiscountPerYear"})]}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mn,{children:"365"}),(0,i.jsx)(s.mo,{children:"\u22c5"}),(0,i.jsx)(s.mn,{children:"24"}),(0,i.jsx)(s.mo,{children:"\u22c5"}),(0,i.jsx)(s.mn,{children:"60"}),(0,i.jsx)(s.mo,{children:"\u22c5"}),(0,i.jsx)(s.mn,{children:"60"})]})]}),(0,i.jsx)(s.mo,{fence:"true",children:")"})]})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\text{answer} = \\text{lpMaturedPrice} \\cdot\n    \\min\\left(\n        10^{18},\n        10^{18} - \\frac{(\\text{maturity} - t) \\cdot \\text{baseDiscountPerYear}}{365 \\cdot 24 \\cdot 60 \\cdot 60} \n    \\right)"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"answer"})}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"lpMaturedPrice"})}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,i.jsx)(s.span,{className:"mop",children:"min"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(s.span,{className:"minner",children:[(0,i.jsx)(s.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(s.span,{className:"delimsizing size3",children:"("})}),(0,i.jsx)(s.span,{className:"mord",children:"1"}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord",children:"0"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.8641em"},children:(0,i.jsxs)(s.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"18"})})})]})})})})})]}),(0,i.jsx)(s.span,{className:"mpunct",children:","}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(s.span,{className:"mord",children:"1"}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord",children:"0"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.8641em"},children:(0,i.jsxs)(s.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:(0,i.jsx)(s.span,{className:"mord mtight",children:"18"})})})]})})})})})]}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(s.span,{className:"mfrac",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsxs)(s.span,{className:"vlist",style:{height:"1.427em"},children:[(0,i.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord",children:"365"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mord",children:"24"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mord",children:"60"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mord",children:"60"})]})]}),(0,i.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"maturity"})}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(s.span,{className:"mclose",children:")"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"baseDiscountPerYear"})})]})]})]}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(s.span,{})})})]})}),(0,i.jsx)(s.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(s.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(s.span,{className:"delimsizing size3",children:")"})})]})]})]})]})})]})]})}function o(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,a)=>{a.d(s,{R:()=>l,x:()=>t});var n=a(6540);const i={},r=n.createContext(i);function l(e){const s=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);