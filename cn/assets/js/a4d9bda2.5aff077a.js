"use strict";(self.webpackChunkpendle_documentation=self.webpackChunkpendle_documentation||[]).push([[4571],{3905:(a,e,t)=>{t.d(e,{Zo:()=>o,kt:()=>k});var n=t(7294);function s(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function m(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,n)}return t}function r(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?m(Object(t),!0).forEach((function(e){s(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function p(a,e){if(null==a)return{};var t,n,s=function(a,e){if(null==a)return{};var t,n,s={},m=Object.keys(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||(s[t]=a[t]);return s}(a,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(s[t]=a[t])}return s}var l=n.createContext({}),i=function(a){var e=n.useContext(l),t=e;return a&&(t="function"==typeof a?a(e):r(r({},e),a)),t},o=function(a){var e=i(a.components);return n.createElement(l.Provider,{value:e},a.children)},c="mdxType",N={inlineCode:"code",wrapper:function(a){var e=a.children;return n.createElement(n.Fragment,{},e)}},h=n.forwardRef((function(a,e){var t=a.components,s=a.mdxType,m=a.originalType,l=a.parentName,o=p(a,["components","mdxType","originalType","parentName"]),c=i(t),h=s,k=c["".concat(l,".").concat(h)]||c[h]||N[h]||m;return t?n.createElement(k,r(r({ref:e},o),{},{components:t})):n.createElement(k,r({ref:e},o))}));function k(a,e){var t=arguments,s=e&&e.mdxType;if("string"==typeof a||s){var m=t.length,r=new Array(m);r[0]=h;var p={};for(var l in e)hasOwnProperty.call(e,l)&&(p[l]=e[l]);p.originalType=a,p[c]="string"==typeof a?a:s,r[1]=p;for(var i=2;i<m;i++)r[i]=t[i];return n.createElement.apply(null,r)}return n.createElement.apply(null,t)}h.displayName="MDXCreateElement"},6007:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>R,contentTitle:()=>S,default:()=>C,frontMatter:()=>T,metadata:()=>L,toc:()=>O});var n=t(7462),s=t(7294),m=t(3905),r=t(6010),p=t(2466),l=t(6550),i=t(1980),o=t(7392),c=t(12);function N(a){return function(a){return s.Children.map(a,(a=>{if(!a||(0,s.isValidElement)(a)&&function(a){const{props:e}=a;return!!e&&"object"==typeof e&&"value"in e}(a))return a;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof a.type?a.type:a.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(a).map((a=>{let{props:{value:e,label:t,attributes:n,default:s}}=a;return{value:e,label:t,attributes:n,default:s}}))}function h(a){const{values:e,children:t}=a;return(0,s.useMemo)((()=>{const a=e??N(t);return function(a){const e=(0,o.l)(a,((a,e)=>a.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((a=>a.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(a),a}),[e,t])}function k(a){let{value:e,tabValues:t}=a;return t.some((a=>a.value===e))}function d(a){let{queryString:e=!1,groupId:t}=a;const n=(0,l.k6)(),m=function(a){let{queryString:e=!1,groupId:t}=a;if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,i._X)(m),(0,s.useCallback)((a=>{if(!m)return;const e=new URLSearchParams(n.location.search);e.set(m,a),n.replace({...n.location,search:e.toString()})}),[m,n])]}function u(a){const{defaultValue:e,queryString:t=!1,groupId:n}=a,m=h(a),[r,p]=(0,s.useState)((()=>function(a){let{defaultValue:e,tabValues:t}=a;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!k({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map((a=>a.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find((a=>a.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:e,tabValues:m}))),[l,i]=d({queryString:t,groupId:n}),[o,N]=function(a){let{groupId:e}=a;const t=function(a){return a?`docusaurus.tab.${a}`:null}(e),[n,m]=(0,c.Nk)(t);return[n,(0,s.useCallback)((a=>{t&&m.set(a)}),[t,m])]}({groupId:n}),u=(()=>{const a=l??o;return k({value:a,tabValues:m})?a:null})();(0,s.useLayoutEffect)((()=>{u&&p(u)}),[u]);return{selectedValue:r,selectValue:(0,s.useCallback)((a=>{if(!k({value:a,tabValues:m}))throw new Error(`Can't select invalid tab value=${a}`);p(a),i(a),N(a)}),[i,N,m]),tabValues:m}}var g=t(2389);const w={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function f(a){let{className:e,block:t,selectedValue:m,selectValue:l,tabValues:i}=a;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,p.o5)(),N=a=>{const e=a.currentTarget,t=o.indexOf(e),n=i[t].value;n!==m&&(c(e),l(n))},h=a=>{let e=null;switch(a.key){case"Enter":N(a);break;case"ArrowRight":{const t=o.indexOf(a.currentTarget)+1;e=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(a.currentTarget)-1;e=o[t]??o[o.length-1];break}}e?.focus()};return s.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},e)},i.map((a=>{let{value:e,label:t,attributes:p}=a;return s.createElement("li",(0,n.Z)({role:"tab",tabIndex:m===e?0:-1,"aria-selected":m===e,key:e,ref:a=>o.push(a),onKeyDown:h,onClick:N},p,{className:(0,r.Z)("tabs__item",w.tabItem,p?.className,{"tabs__item--active":m===e})}),t??e)})))}function y(a){let{lazy:e,children:t,selectedValue:n}=a;const m=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const a=m.find((a=>a.props.value===n));return a?(0,s.cloneElement)(a,{className:"margin-top--md"}):null}return s.createElement("div",{className:"margin-top--md"},m.map(((a,e)=>(0,s.cloneElement)(a,{key:e,hidden:a.props.value!==n}))))}function b(a){const e=u(a);return s.createElement("div",{className:(0,r.Z)("tabs-container",w.tabList)},s.createElement(f,(0,n.Z)({},a,e)),s.createElement(y,(0,n.Z)({},a,e)))}function v(a){const e=(0,g.Z)();return s.createElement(b,(0,n.Z)({key:String(e)},a))}const x={tabItem:"tabItem_Ymn6"};function P(a){let{children:e,hidden:t,className:n}=a;return s.createElement("div",{role:"tabpanel",className:(0,r.Z)(x.tabItem,n),hidden:t},e)}const T={hide_table_of_contents:!0},S="How to Integrate PT and LP Oracle",L={unversionedId:"Developers/Oracles/HowToIntegratePtAndLpOracle",id:"Developers/Oracles/HowToIntegratePtAndLpOracle",title:"How to Integrate PT and LP Oracle",description:"Integrating PT and LP oracles into your system can be accomplished in the following steps. This document provides detailed instructions along with runnable examples.",source:"@site/docs/Developers/Oracles/HowToIntegratePtAndLpOracle.md",sourceDirName:"Developers/Oracles",slug:"/Developers/Oracles/HowToIntegratePtAndLpOracle",permalink:"/cn/Developers/Oracles/HowToIntegratePtAndLpOracle",draft:!1,tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"myAutogeneratedSidebar",previous:{title:"Fill a Limit Order",permalink:"/cn/Developers/LimitOrder/FillALimitOrder"},next:{title:"Introduction of LP Oracle",permalink:"/cn/Developers/Oracles/IntroductionOfLpOracle"}},R={},O=[{value:"Prerequisite",id:"prerequisite",level:2},{value:"Understand SY, PT, LP",id:"understand-sy-pt-lp",level:3},{value:"Follow security advisories",id:"follow-security-advisories",level:3},{value:"Choose a Market",id:"choose-a-market",level:2},{value:"TWAP Duration and Oracle Initialization",id:"twap-duration-and-oracle-initialization",level:2},{value:"Point (1) - Oracle needs to be initialized",id:"point-1---oracle-needs-to-be-initialized",level:3},{value:"Point (2) - Need to wait for data to be available",id:"point-2---need-to-wait-for-data-to-be-available",level:3},{value:"Point (3) - Oracle is ready",id:"point-3---oracle-is-ready",level:3},{value:"Price Retrieval",id:"price-retrieval",level:2},{value:"Step 1. Deploy the oracle (if not already deployed)",id:"step-1-deploy-the-oracle-if-not-already-deployed",level:3},{value:"Step 2. Call the oracle",id:"step-2-call-the-oracle",level:3},{value:"Optional: Convert the price to a different asset",id:"optional-convert-the-price-to-a-different-asset",level:3},{value:"Optional: Convert the price to a different asset",id:"optional-convert-the-price-to-a-different-asset-1",level:3},{value:"Handle liquidation &amp; LP&#39;s rewards",id:"handle-liquidation--lps-rewards",level:2},{value:"For PT liquidation",id:"for-pt-liquidation",level:3},{value:"For LP liquidation",id:"for-lp-liquidation",level:3},{value:"Handling of Pendle LP&#39;s rewards:",id:"handling-of-pendle-lps-rewards",level:3}],E={toc:O},M="wrapper";function C(a){let{components:e,...t}=a;return(0,m.kt)(M,(0,n.Z)({},E,t,{components:e,mdxType:"MDXLayout"}),(0,m.kt)("h1",{id:"how-to-integrate-pt-and-lp-oracle"},"How to Integrate PT and LP Oracle"),(0,m.kt)("p",null,"Integrating PT and LP oracles into your system can be accomplished in the following steps. This document provides detailed instructions along with runnable examples."),(0,m.kt)("p",null,"If you need personalized assistance, don't hesitate to contact us via our Developers channel on ",(0,m.kt)("a",{parentName:"p",href:"https://pendle.finance/discord"},"Pendle Discord"),"."),(0,m.kt)("h2",{id:"prerequisite"},"Prerequisite"),(0,m.kt)("h3",{id:"understand-sy-pt-lp"},"Understand SY, PT, LP"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"Read ",(0,m.kt)("a",{parentName:"li",href:"/cn/Developers/HighLevelArchitecture"},"High Level Architecture")," and ",(0,m.kt)("a",{parentName:"li",href:"/cn/Developers/Contracts/StandardizedYield"},"StandardizedYield docs")," to understand the Pendle system."),(0,m.kt)("li",{parentName:"ul"},"Refer to the examples in the following repository for further understanding:",(0,m.kt)("ul",{parentName:"li"},(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("a",{parentName:"li",href:"https://github.com/pendle-finance/pendle-examples/tree/main/test"},"https://github.com/pendle-finance/pendle-examples/tree/main/test")),(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("a",{parentName:"li",href:"https://github.com/pendle-finance/pendle-core-v2-public/tree/main/contracts/oracles"},"https://github.com/pendle-finance/pendle-core-v2-public/tree/main/contracts/oracles"))))),(0,m.kt)("h3",{id:"follow-security-advisories"},"Follow security advisories"),(0,m.kt)("p",null,"As Pendle becomes more permissionless, certain security assumptions of SY will\nchange in the future, and the Pendle team will verify for all teams currently\nintegrating the LP Oracle that their integration meets the new ",(0,m.kt)("strong",{parentName:"p"},"security\nassumptions")," of SY. Please reach out to us on ",(0,m.kt)("a",{parentName:"p",href:"https://pendle.finance/discord"},"Pendle Discord")," if you have any\nquestions."),(0,m.kt)("h2",{id:"choose-a-market"},"Choose a Market"),(0,m.kt)("p",null,"In this documentation and the code example, EtherFi's ",(0,m.kt)("a",{parentName:"p",href:"https://arbiscan.io/address/0x952083cde7aaa11AB8449057F7de23A970AA8472"},"weETH market")," on Arbitrum,\nwhich has 70M USD liquidity at block 192 001 277, is chosen."),(0,m.kt)("p",null,"We recommend choosing a market with high trading activities & deep liquidity.\nFor a detailed guide on assessing the risk, depth of liquidity & twap\nduration, refer to the corresponding risk assessment docs."),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("a",{parentName:"li",href:"/cn/Developers/Oracles/PTAsCollateral#risk-analysis-for-pt-as-a-collateral"},"For using PT as collateral")),(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("a",{parentName:"li",href:"/cn/Developers/Oracles/LPAsCollateral#risk-analysis-for-lp-as-a-collateral"},"For using LP as collateral"))),(0,m.kt)("h2",{id:"twap-duration-and-oracle-initialization"},"TWAP Duration and Oracle Initialization"),(0,m.kt)("p",null,"By default, markets' oracles are ",(0,m.kt)("strong",{parentName:"p"},"NOT initialized"),". The oracle's status can be checked using the ",(0,m.kt)("inlineCode",{parentName:"p"},"_test_oracle_ready")," function (",(0,m.kt)("a",{parentName:"p",href:"https://github.com/pendle-finance/pendle-examples-public/blob/642b1ab2784b3015691d6c26a2684cd5f7585b0d/test/OracleSample.sol#L75-L91"},"source"),")."),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"The passed in ",(0,m.kt)("inlineCode",{parentName:"li"},"duration")," is the TWAP duration (in seconds) you want to use.",(0,m.kt)("ul",{parentName:"li"},(0,m.kt)("li",{parentName:"ul"},"The recommended TWAP duration is 900 seconds (15 minutes) for most markets or 1800 seconds (30 minutes).")))),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},"function _test_oracle_ready(address marketToCheck, uint32 duration) public view {\n    (bool increaseCardinalityRequired, , bool oldestObservationSatisfied) =\n        oracle.getOracleState(marketToCheck, duration);\n\n    if (increaseCardinalityRequired) {\n        // <=============== (1) - Oracle need to be initialized\n    }\n\n    if (!oldestObservationSatisfied) {\n        // <=============== (2) - Need to wait for data to be available\n    }\n\n    // <=============== (3) - Oracle is ready\n    assert(!increaseCardinalityRequired);\n    assert(oldestObservationSatisfied);\n}\n")),(0,m.kt)("h3",{id:"point-1---oracle-needs-to-be-initialized"},"Point (1) - Oracle needs to be initialized"),(0,m.kt)("p",null,"At this point, the oracle needs to be initialized. This can be done by calling the following yourself:"),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},"IPMarket(market).increaseObservationsCardinalityNext(cardinalityRequired)\n")),(0,m.kt)("p",null," Here are possible values for ",(0,m.kt)("inlineCode",{parentName:"p"},"cardinalityRequired"),":"),(0,m.kt)("table",null,(0,m.kt)("thead",{parentName:"table"},(0,m.kt)("tr",{parentName:"thead"},(0,m.kt)("th",{parentName:"tr",align:null},(0,m.kt)("inlineCode",{parentName:"th"},"duration")," (seconds)"),(0,m.kt)("th",{parentName:"tr",align:null},(0,m.kt)("inlineCode",{parentName:"th"},"900")),(0,m.kt)("th",{parentName:"tr",align:null},(0,m.kt)("inlineCode",{parentName:"th"},"1800")))),(0,m.kt)("tbody",{parentName:"table"},(0,m.kt)("tr",{parentName:"tbody"},(0,m.kt)("td",{parentName:"tr",align:null},"For Ethereum"),(0,m.kt)("td",{parentName:"tr",align:null},"85"),(0,m.kt)("td",{parentName:"tr",align:null},"165")),(0,m.kt)("tr",{parentName:"tbody"},(0,m.kt)("td",{parentName:"tr",align:null},"For Arbitrum"),(0,m.kt)("td",{parentName:"tr",align:null},"900"),(0,m.kt)("td",{parentName:"tr",align:null},"1800")))),(0,m.kt)("p",null,"So on Ethereum, for ",(0,m.kt)("inlineCode",{parentName:"p"},"duration")," of 900 seconds, ",(0,m.kt)("inlineCode",{parentName:"p"},"cardinalityRequired")," can be 85."),(0,m.kt)("details",null,(0,m.kt)("summary",null,"Calculate ",(0,m.kt)("code",null,"cardinalityRequired")),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre"},"In general, it can calculated like this\n\n$$\n\\mathtt{cardinalityRequired} \\approx\n    \\frac\n        {\\mathtt{duration}}\n        {\\max\\{\\mathrm{\\text{chain block time}}, 1\\}}\n$$\n"))),(0,m.kt)("p",null,"After that, you need ",(0,m.kt)("strong",{parentName:"p"},"to wait")," for ",(0,m.kt)("inlineCode",{parentName:"p"},"duration")," seconds for the first data to be available."),(0,m.kt)("h3",{id:"point-2---need-to-wait-for-data-to-be-available"},"Point (2) - Need to wait for data to be available"),(0,m.kt)("p",null,"Similar to the previous point, you need ",(0,m.kt)("strong",{parentName:"p"},"to wait")," for ",(0,m.kt)("inlineCode",{parentName:"p"},"duration")," seconds for the first data to be available."),(0,m.kt)("h3",{id:"point-3---oracle-is-ready"},"Point (3) - Oracle is ready"),(0,m.kt)("p",null,"Now you can call functions to get the observed price!"),(0,m.kt)("h2",{id:"price-retrieval"},"Price Retrieval"),(0,m.kt)("p",null,"We have provided a few ways to obtain the price. Select one of the following\ntab to choose the one that best suits your needs."),(0,m.kt)(v,{mdxType:"Tabs"},(0,m.kt)(P,{value:"chainlink-oracle",label:"Using ChainLink oracle",default:!0,mdxType:"TabItem"},(0,m.kt)("p",null,"We have provided a way to the price, with the same interface as ChainLink oracles."),(0,m.kt)("p",null,"The source code of the whole example can be found here:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("a",{parentName:"li",href:"https://github.com/pendle-finance/pendle-examples-public/blob/main/test/ChainlinkOracleSample.sol"},"https://github.com/pendle-finance/pendle-examples-public/blob/main/test/ChainlinkOracleSample.sol"))),(0,m.kt)("h3",{id:"step-1-deploy-the-oracle-if-not-already-deployed"},"Step 1. Deploy the oracle (if not already deployed)"),(0,m.kt)("p",null,"If the oracle are not already deployed, you can deploy yourself the same as this ",(0,m.kt)("inlineCode",{parentName:"p"},"setUp")," function (",(0,m.kt)("a",{parentName:"p",href:"https://github.com/pendle-finance/pendle-examples-public/blob/642b1ab2784b3015691d6c26a2684cd5f7585b0d/test/ChainlinkOracleSample.sol#L30-L41"},"source"),")."),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity",metastring:'title="code fragment of setUp function"',title:'"code',fragment:!0,of:!0,setUp:!0,'function"':!0},"factory = new PendleChainlinkOracleFactory(0x9a9Fa8338dd5E5B2188006f1Cd2Ef26d921650C2);\nPT_LBTC_oracle = PendleChainlinkOracle(\n    factory.createOracle(address(market), twapDuration, PendleOracleType.PT_TO_SY)\n);\n\nPT_USD_oracle = PendleChainlinkOracleWithQuote(\n    factory.createOracleWithQuote(address(market), twapDuration, PendleOracleType.PT_TO_SY, address(LBTC_USD_feed))\n);\n")),(0,m.kt)("details",null,(0,m.kt)("summary",null,"Parameters summary"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("inlineCode",{parentName:"li"},"market")," is the market address you want to observe the price."),(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("inlineCode",{parentName:"li"},"twapDuration")," is the TWAP duration you want to use, chosen in the previous section."),(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("inlineCode",{parentName:"li"},"0x9a9Fa8338dd5E5B2188006f1Cd2Ef26d921650C2")," is the address of the deployed Pendle Oracle.",(0,m.kt)("ul",{parentName:"li"},(0,m.kt)("li",{parentName:"ul"},"It was deployed to have the same address for all network."),(0,m.kt)("li",{parentName:"ul"},"Refer to ",(0,m.kt)("a",{parentName:"li",href:"/cn/Developers/Deployments/Ethereum"},"Deployment")," section for the full list of addresses."),(0,m.kt)("li",{parentName:"ul"},"The deployed ChainLink oracles ",(0,m.kt)("strong",{parentName:"li"},"wrap")," this oracle."),(0,m.kt)("li",{parentName:"ul"},"Please refer to the ",(0,m.kt)("em",{parentName:"li"},"Using Pendle Oracle")," way if you want to use it directly."))))),(0,m.kt)("p",null,"When deploy the oracle, you need to specified the type:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("inlineCode",{parentName:"li"},"PendleOracleType.PT_TO_SY")," - to get the price of PT in SY."),(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("inlineCode",{parentName:"li"},"PendleOracleType.PT_TO_ASSET")," - to get the price of PT in the underlying asset.")),(0,m.kt)("p",null,"We support 2 contracts for obtaining the price:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("inlineCode",{parentName:"li"},"PendleChainlinkOracle")," - to get the price of PT in SY/asset."),(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("inlineCode",{parentName:"li"},"PendleChainlinkOracleWithQuote")," - to get price of PT in a different token if you have the ChainLink oracle of that token with the underlying asset.")),(0,m.kt)("h3",{id:"step-2-call-the-oracle"},"Step 2. Call the oracle"),(0,m.kt)("p",null,"Price can be obtained simply by calling the ",(0,m.kt)("inlineCode",{parentName:"p"},"getLatestRoundData")," function (",(0,m.kt)("a",{parentName:"p",href:"https://github.com/pendle-finance/pendle-examples-public/blob/642b1ab2784b3015691d6c26a2684cd5f7585b0d/test/ChainlinkOracleSample.sol#L43-L54"},"source"),")."),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},'function test_get_prices_in_SY() external view {\n    (uint80 roundId, int256 answer, , uint256 updatedAt, uint80 answeredInRound) = PT_LBTC_oracle.latestRoundData();\n    console.log("PT LBTC to SY-LBTC");\n    console.log(uint256(roundId), uint256(answer), updatedAt, uint256(answeredInRound));\n    // answer = 992893819205953801, meaning 1 PT = 0.992893819205953801 SY-LBTC\n}\n\nfunction test_get_prices_in_quote() external view {\n    (uint80 roundId, int256 answer, , uint256 updatedAt, uint80 answeredInRound) = PT_USD_oracle.latestRoundData();\n    console.log("PT LBTC to BTC");\n    console.log(uint256(roundId), uint256(answer), updatedAt, uint256(answeredInRound));\n    // answer = 990999427443599801, meaning 1 PT = 0.9909994274435997 BTC\n}\n'))),(0,m.kt)(P,{value:"pendle-oracle",label:"Using Pendle Oracle",mdxType:"TabItem"},(0,m.kt)("p",null,"The source code of the whole example can be found here:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("a",{parentName:"li",href:"https://github.com/pendle-finance/pendle-examples-public/blob/main/test/OracleSample.sol"},"https://github.com/pendle-finance/pendle-examples-public/blob/main/test/OracleSample.sol"))),(0,m.kt)("p",null,"We have deployed an a contract that helps obtaining the price of PT/YT/LP token in SY or asset."),(0,m.kt)("p",null,"The contract is at address ",(0,m.kt)("inlineCode",{parentName:"p"},"0x9a9Fa8338dd5E5B2188006f1Cd2Ef26d921650C2"),"."),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"It was deployed to have the same address for all network."),(0,m.kt)("li",{parentName:"ul"},"Refer to ",(0,m.kt)("a",{parentName:"li",href:"/cn/Developers/Deployments/Ethereum"},"Deployment")," section for the full list of addresses.")),(0,m.kt)("p",null,"Getting the price can be done simply by calling the corresponding function (",(0,m.kt)("a",{parentName:"p",href:"https://github.com/pendle-finance/pendle-examples-public/blob/642b1ab2784b3015691d6c26a2684cd5f7585b0d/test/OracleSample.sol#L38-L46"},"source"),")."),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},'function test_get_price_LRT_in_underlying() external view {\n    uint256 ptRateInWeEth = oracle.getPtToSyRate(address(market), twapDuration);\n    uint256 ytRateInWeEth = oracle.getYtToSyRate(address(market), twapDuration);\n    uint256 lpRateInWeEth = oracle.getLpToSyRate(address(market), twapDuration);\n\n    console.log("1 PT = %s Wrapped eEth (base 1e18)", ptRateInWeEth);\n    console.log("1 YT = %s Wrapped eEth (base 1e18)", ytRateInWeEth);\n    console.log("1 LP = %s Wrapped eEth (base 1e18)", lpRateInWeEth);\n}\n')),(0,m.kt)("h3",{id:"optional-convert-the-price-to-a-different-asset"},"Optional: Convert the price to a different asset"),(0,m.kt)("p",null,"Additionally, if you have an on-chain feed for the price of the underlying asset with a different token, you can ",(0,m.kt)("strong",{parentName:"p"},"convert")," the price using multiplication."),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},'function test_get_price_LRT_with_external_oracle() external view {\n    uint256 ptRateInWeEth = oracle.getPtToSyRate(address(market), twapDuration); // 1 SY-weETH = 1 weETH\n\n    uint256 ptRateInEth = (ptRateInWeEth * uint256(weETH_ETH_feed.latestAnswer())) / (10 ** weETH_ETH_feed.decimals());\n    console.log("1 PT = %s ETH (base 1e18)", ptRateInEth); // 1 PT = 0.980103943942239852 ETH\n\n    uint256 ptRateInUsd = (ptRateInEth * uint256(ETH_USD_feed.latestAnswer())) / (10 ** ETH_USD_feed.decimals());\n    console.log("1 PT = %s USD (base 1e18)", ptRateInUsd); // 1 PT = 3714.1302603652102 USD\n}\n'))),(0,m.kt)(P,{value:"pendle-library",label:"Using Pendle Library",mdxType:"TabItem"},(0,m.kt)("p",null,"The source code of the whole example can be found here:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},(0,m.kt)("a",{parentName:"li",href:"https://github.com/pendle-finance/pendle-examples-public/blob/main/test/OracleSample.sol"},"https://github.com/pendle-finance/pendle-examples-public/blob/main/test/OracleSample.sol"))),(0,m.kt)("p",null,"This library is used in the Pendle Oracle (refer to ",(0,m.kt)("em",{parentName:"p"},"Using Pendle Oracle")," section). But it can also be used directly in your contract source code. This can help save ",(0,m.kt)("strong",{parentName:"p"},"about 4k gas"),"!"),(0,m.kt)("p",null,"Before using it, import it as follows:"),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},'import {\n    PendlePYOracleLib,\n    PendleLpOracleLib\n} from "@pendle/core-v2/contracts/oracles/PtYtLpOracle/PendlePYLpOracle.sol";\n\ncontract YourContract {\n    using PendlePYOracleLib for IPMarket;\n    using PendleLpOracleLib for IPMarket;\n    // ...\n}\n')),(0,m.kt)("p",null,"Then you can call the functions directly on the market address."),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},'function test_get_price_LRT_in_underlying_with_lib() external view {\n    uint256 ptRateInWeEth = market.getPtToSyRate(twapDuration);\n    uint256 ytRateInWeEth = market.getYtToSyRate(twapDuration);\n    uint256 lpRateInWeEth = market.getLpToSyRate(twapDuration);\n\n    console.log("1 PT = %s Wrapped eEth (base 1e18)", ptRateInWeEth);\n    console.log("1 YT = %s Wrapped eEth (base 1e18)", ytRateInWeEth);\n    console.log("1 LP = %s Wrapped eEth (base 1e18)", lpRateInWeEth);\n}\n')),(0,m.kt)("p",null,"Refer to ",(0,m.kt)("a",{parentName:"p",href:"/cn/Developers/Contracts/StandardizedYield"},"StandardizedYield docs")," to call the correct function."),(0,m.kt)("h3",{id:"optional-convert-the-price-to-a-different-asset-1"},"Optional: Convert the price to a different asset"),(0,m.kt)("p",null,"Additionally, if you have an on-chain feed for the price of the underlying asset with a different token, you can ",(0,m.kt)("strong",{parentName:"p"},"convert")," the price using multiplication."),(0,m.kt)("pre",null,(0,m.kt)("code",{parentName:"pre",className:"language-solidity"},'function test_get_price_LRT_with_external_oracle_with_lib() external view {\n    uint256 ptRateInWeEth = market.getPtToSyRate(twapDuration); // 1 SY-weETH = 1 weETH\n\n    uint256 ptRateInEth = (ptRateInWeEth * uint256(weETH_ETH_feed.latestAnswer())) / (10 ** weETH_ETH_feed.decimals());\n    console.log("1 PT = %s ETH (base 1e18)", ptRateInEth); // 1 PT = 0.980103943942239852 ETH\n\n    uint256 ptRateInUsd = (ptRateInEth * uint256(ETH_USD_feed.latestAnswer())) / (10 ** ETH_USD_feed.decimals());\n    console.log("1 PT = %s USD (base 1e18)", ptRateInUsd); // 1 PT = 3714.1302603652102 USD\n}\n')))),(0,m.kt)("admonition",{type:"warning"},(0,m.kt)("mdxAdmonitionTitle",{parentName:"admonition"},"We recommend pricing PT to ",(0,m.kt)("u",null,"SY")," instead of asset."),(0,m.kt)("p",{parentName:"admonition"},"For SY to any other units, the integrator can choose an appropriate method\nbased on whether the asset can be directly redeemed from the SY or if there is\na slashing risk, etc. Pendle can not provide a perfect PT to Asset price because\nAsset price is not well defined."),(0,m.kt)("details",null,(0,m.kt)("summary",null,"Pendle can not provide a perfect PT to asset price"),(0,m.kt)("p",{parentName:"admonition"},"Let's take a look at the example of PT-sUSDe/SY-sUSDe with asset being USDe."),(0,m.kt)("p",{parentName:"admonition"},"Pendle can guarantee 1 PT-sUSDe can be traded to ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"X")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X")))))," SY-sUSDe = ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"X")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X")))))," sUSDe. PT to SY price ",(0,m.kt)("strong",{parentName:"p"},"exists natively"),"."),(0,m.kt)("p",{parentName:"admonition"},"On the other hand, Pendle ",(0,m.kt)("strong",{parentName:"p"},"can not")," guarantee sUSDe is redeemable to some amount of USDe. Which now traced back to: SY-sUSDe\u2019s asset is not USDe, but USDe staked in Ethena, hence the price of this is not ",(0,m.kt)("strong",{parentName:"p"},"well defined"),"."),(0,m.kt)("hr",{parentName:"admonition"}),(0,m.kt)("p",{parentName:"admonition"},"Because of this, in case when sUSDe depegged from USDe, the conversion rate between PT-sUSDe to sUSDe is still correct, because the conversion rate is based on ",(0,m.kt)("inlineCode",{parentName:"p"},"SY.exchangeRate()"),", which is provided by the underlying contract."))),(0,m.kt)("admonition",{title:"About unit and decimals",type:"info"},(0,m.kt)("p",{parentName:"admonition"},"As the ",(0,m.kt)("inlineCode",{parentName:"p"},"decimals")," is a token metadata, and only be used to show the amount to\nthe users, Pendle contract does ",(0,m.kt)("strong",{parentName:"p"},"not")," operate with decimals. See the documentation about ",(0,m.kt)("a",{parentName:"p",href:"/cn/Developers/Contracts/UnitAndDecimals"},"unit and decimals")," for more info."),(0,m.kt)("p",{parentName:"admonition"},"Let's say you want to know how much ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"X")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X")))))," LP is worth in SY."),(0,m.kt)("p",{parentName:"admonition"},"First, we convert ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"X")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X")))))," into the ",(0,m.kt)("strong",{parentName:"p"},"raw")," format so that the contract can understand."),(0,m.kt)("div",{parentName:"admonition",className:"math math-display"},(0,m.kt)("span",{parentName:"div",className:"katex-display"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"r"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"a"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"w"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"X")),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mi",{parentName:"mrow"},"X"),(0,m.kt)("mo",{parentName:"mrow"},"\xd7"),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mn",{parentName:"msup"},"0"),(0,m.kt)("mrow",{parentName:"msup"},(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"L"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"P")),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"d"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"e"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"c"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"i"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"m"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"a"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"l"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"s"))))),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\mathtt{rawX} = X \\times 10^{\\mathtt{LP}.\\mathtt{decimals}}")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.61111em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"r"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"a"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"w"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"X")),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,m.kt)("span",{parentName:"span",className:"mrel"},"="),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.76666em",verticalAlign:"-0.08333em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,m.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.840777em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},"1"),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord"},"0"),(0,m.kt)("span",{parentName:"span",className:"msupsub"},(0,m.kt)("span",{parentName:"span",className:"vlist-t"},(0,m.kt)("span",{parentName:"span",className:"vlist-r"},(0,m.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.840777em"}},(0,m.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,m.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,m.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"L"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"P")),(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"."),(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"d"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"e"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"c"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"i"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"m"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"a"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"l"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"s"))))))))))))))),(0,m.kt)("p",{parentName:"admonition"},"After obtaining the ",(0,m.kt)("inlineCode",{parentName:"p"},"lpToSyRate"),", we convert ",(0,m.kt)("inlineCode",{parentName:"p"},"rawX")," to the ",(0,m.kt)("strong",{parentName:"p"},"raw")," form of SY as follows:"),(0,m.kt)("div",{parentName:"admonition",className:"math math-display"},(0,m.kt)("span",{parentName:"div",className:"katex-display"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"r"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"a"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"w"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"Y")),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"r"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"a"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"w"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"X")),(0,m.kt)("mo",{parentName:"mrow"},"\xd7"),(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"l"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"p"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"T"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"o"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"S"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"y"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"R"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"a"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"t"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"e")),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mn",{parentName:"msup"},"0"),(0,m.kt)("mn",{parentName:"msup"},"18"))),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\mathtt{rawY} = \\mathtt{rawX} \\times \\mathtt{lpToSyRate} / 10^{18}")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.61111em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"r"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"a"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"w"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"Y")),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,m.kt)("span",{parentName:"span",className:"mrel"},"="),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944400000000001em",verticalAlign:"-0.08333em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"r"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"a"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"w"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"X")),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,m.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1.1141079999999999em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"l"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"p"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"T"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"o"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"y"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"R"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"a"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"t"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"e")),(0,m.kt)("span",{parentName:"span",className:"mord"},"/"),(0,m.kt)("span",{parentName:"span",className:"mord"},"1"),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord"},"0"),(0,m.kt)("span",{parentName:"span",className:"msupsub"},(0,m.kt)("span",{parentName:"span",className:"vlist-t"},(0,m.kt)("span",{parentName:"span",className:"vlist-r"},(0,m.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8641079999999999em"}},(0,m.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,m.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,m.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"1"),(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"8")))))))))))))),(0,m.kt)("blockquote",{parentName:"admonition"},(0,m.kt)("p",{parentName:"blockquote"},"Note that ",(0,m.kt)("span",{parentName:"p",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mn",{parentName:"msup"},"0"),(0,m.kt)("mn",{parentName:"msup"},"18"))),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"10^{18}")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141079999999999em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},"1"),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord"},"0"),(0,m.kt)("span",{parentName:"span",className:"msupsub"},(0,m.kt)("span",{parentName:"span",className:"vlist-t"},(0,m.kt)("span",{parentName:"span",className:"vlist-r"},(0,m.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141079999999999em"}},(0,m.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,m.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,m.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"1"),(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"8")))))))))))))," is a fixed number in the formula, and does not depend on any ",(0,m.kt)("inlineCode",{parentName:"p"},"decimals")," data.")),(0,m.kt)("p",{parentName:"admonition"},"Finally, we can convert ",(0,m.kt)("inlineCode",{parentName:"p"},"rawY")," to the human-readable format:"),(0,m.kt)("div",{parentName:"admonition",className:"math math-display"},(0,m.kt)("span",{parentName:"div",className:"katex-display"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"Y"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"r"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"a"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"w"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"Y")),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"/"),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mn",{parentName:"msup"},"0"),(0,m.kt)("mrow",{parentName:"msup"},(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"S"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"Y")),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"d"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"e"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"c"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"i"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"m"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"a"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"l"),(0,m.kt)("mi",{parentName:"mrow",mathvariant:"monospace"},"s"))))),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"Y = \\mathtt{rawY} / 10^{\\mathtt{SY}.\\mathtt{decimals}}")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y"),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,m.kt)("span",{parentName:"span",className:"mrel"},"="),(0,m.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"1.090777em",verticalAlign:"-0.25em"}}),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"r"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"a"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"w"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt"},"Y")),(0,m.kt)("span",{parentName:"span",className:"mord"},"/"),(0,m.kt)("span",{parentName:"span",className:"mord"},"1"),(0,m.kt)("span",{parentName:"span",className:"mord"},(0,m.kt)("span",{parentName:"span",className:"mord"},"0"),(0,m.kt)("span",{parentName:"span",className:"msupsub"},(0,m.kt)("span",{parentName:"span",className:"vlist-t"},(0,m.kt)("span",{parentName:"span",className:"vlist-r"},(0,m.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.840777em"}},(0,m.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,m.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,m.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"Y")),(0,m.kt)("span",{parentName:"span",className:"mord mtight"},"."),(0,m.kt)("span",{parentName:"span",className:"mord mtight"},(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"d"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"e"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"c"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"i"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"m"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"a"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"l"),(0,m.kt)("span",{parentName:"span",className:"mord mathtt mtight"},"s"))))))))))))))),(0,m.kt)("p",{parentName:"admonition"},"Conversion between PT/YT and SY is done similarly."),(0,m.kt)("p",{parentName:"admonition"},"As Pendle support a wide variety of assets, each with a different ",(0,m.kt)("inlineCode",{parentName:"p"},"decimals"),",\nthis fact is important to remember.")),(0,m.kt)("h2",{id:"handle-liquidation--lps-rewards"},"Handle liquidation & LP's rewards"),(0,m.kt)("h3",{id:"for-pt-liquidation"},"For PT liquidation"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"When a liquidation with ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mi",{parentName:"mrow"},"T")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"PT")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T")))))," as collateral occurs, commonly, the liquidator will have to sell ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mi",{parentName:"mrow"},"T")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"PT")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T")))))," into common asset to pay their debt."),(0,m.kt)("li",{parentName:"ul"},"In Pendle's system, we support converting ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mi",{parentName:"mrow"},"T")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"PT")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T")))))," back to ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," by selling ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mi",{parentName:"mrow"},"T")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"PT")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T")))))," on our AMM (before maturity) or redeeming directly from ",(0,m.kt)("inlineCode",{parentName:"li"},"PendleYieldToken")," contract (post maturity). This will then allow the liquidator to redeem their ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," into one of the output token of ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," (see ",(0,m.kt)("a",{parentName:"li",href:"https://eips.ethereum.org/EIPS/eip-5115"},"EIP-5115"),")."),(0,m.kt)("li",{parentName:"ul"},"For reference, we have written the ",(0,m.kt)("a",{parentName:"li",href:"https://github.com/pendle-finance/pendle-core-v2-public/blob/main/contracts/oracles/samples/BoringPtSeller.sol"},(0,m.kt)("inlineCode",{parentName:"a"},"BoringPtSeller"))," contract to sell ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mi",{parentName:"mrow"},"T")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"PT")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T")))))," into one of the output token."),(0,m.kt)("li",{parentName:"ul"},"You can extend this abstract contract to use in a liquidation system.")),(0,m.kt)("h3",{id:"for-lp-liquidation"},"For LP liquidation"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"When a liquidation with ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"L"),(0,m.kt)("mi",{parentName:"mrow"},"P")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"LP")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"L"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P")))))," as collateral occurs, commonly, the liquidator will have to sell ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"L"),(0,m.kt)("mi",{parentName:"mrow"},"P")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"LP")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"L"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P")))))," into common asset to pay their debt."),(0,m.kt)("li",{parentName:"ul"},"In Pendle's system, we support converting ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"L"),(0,m.kt)("mi",{parentName:"mrow"},"P")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"LP")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"L"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P")))))," back to ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," by removing liquidity single-sided into ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," on our AMM (before maturity) or redeeming ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mi",{parentName:"mrow"},"T")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"PT")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T")))))," + ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," and redeeming ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mi",{parentName:"mrow"},"T")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"PT")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T")))))," to ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," directly from ",(0,m.kt)("inlineCode",{parentName:"li"},"PendleYieldToken")," contract (post maturity). This will then allow the liquidator to redeem their ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," into one of the output token of ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"S"),(0,m.kt)("mi",{parentName:"mrow"},"Y")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"SY")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y")))))," (see ",(0,m.kt)("a",{parentName:"li",href:"https://eips.ethereum.org/EIPS/eip-5115"},"EIP-5115"),")."),(0,m.kt)("li",{parentName:"ul"},"For reference, we have written the ",(0,m.kt)("a",{parentName:"li",href:"https://github.com/pendle-finance/pendle-core-v2-public/blob/main/contracts/oracles/samples/BoringLpSeller.sol"},(0,m.kt)("inlineCode",{parentName:"a"},"BoringLpSeller"))," contract to sell ",(0,m.kt)("span",{parentName:"li",className:"math math-inline"},(0,m.kt)("span",{parentName:"span",className:"katex"},(0,m.kt)("span",{parentName:"span",className:"katex-mathml"},(0,m.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"L"),(0,m.kt)("mi",{parentName:"mrow"},"P")),(0,m.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"LP")))),(0,m.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,m.kt)("span",{parentName:"span",className:"base"},(0,m.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal"},"L"),(0,m.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P")))))," into one of SY's output tokens."),(0,m.kt)("li",{parentName:"ul"},"You can extend this abstract contract to use in a liquidation system.")),(0,m.kt)("h3",{id:"handling-of-pendle-lps-rewards"},"Handling of Pendle LP's rewards:"),(0,m.kt)("ul",null,(0,m.kt)("li",{parentName:"ul"},"Holding Pendle LP tokens will generate PENDLE incentives and potential reward tokens (like WETH for LP for GLP pool)"),(0,m.kt)("li",{parentName:"ul"},"The money market contracts will need to redeem these rewards by calling the ",(0,m.kt)("inlineCode",{parentName:"li"},"redeemRewards")," function and implement logic to distribute these rewards to their users")))}C.isMDXComponent=!0}}]);