"use strict";(self.webpackChunkpendle_documentation=self.webpackChunkpendle_documentation||[]).push([[4775],{3905:(e,a,t)=>{t.d(a,{Zo:()=>p,kt:()=>u});var n=t(7294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function s(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?s(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function l(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var o=n.createContext({}),m=function(e){var a=n.useContext(o),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},p=function(e){var a=m(e.components);return n.createElement(o.Provider,{value:a},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},h=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,s=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=m(t),h=r,u=c["".concat(o,".").concat(h)]||c[h]||d[h]||s;return t?n.createElement(u,i(i({ref:a},p),{},{components:t})):n.createElement(u,i({ref:a},p))}));function u(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var s=t.length,i=new Array(s);i[0]=h;var l={};for(var o in a)hasOwnProperty.call(a,o)&&(l[o]=a[o]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var m=2;m<s;m++)i[m]=t[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}h.displayName="MDXCreateElement"},3827:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>m});var n=t(7462),r=(t(7294),t(3905));const s={hide_table_of_contents:!0},i="AMM",l={unversionedId:"ProtocolMechanics/AMM",id:"ProtocolMechanics/AMM",title:"AMM",description:"Pendle\u2019s V2 AMM is designed specifically for trading yield, and takes advantage of the behaviours of PT and YT.",source:"@site/docs/ProtocolMechanics/AMM.md",sourceDirName:"ProtocolMechanics",slug:"/ProtocolMechanics/AMM",permalink:"/ProtocolMechanics/AMM",draft:!1,tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"myAutogeneratedSidebar",previous:{title:"YT",permalink:"/ProtocolMechanics/YieldTokenization/YT"},next:{title:"Tokenomics",permalink:"/ProtocolMechanics/Mechanisms/Tokenomics"}},o={},m=[{value:"Swaps",id:"swaps",level:2},{value:"Flash Swaps",id:"flash-swaps",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Minimal Impermanent Loss (IL)",id:"minimal-impermanent-loss-il",level:3},{value:"Customizable AMM",id:"customizable-amm",level:3},{value:"Greater Capital Efficiency",id:"greater-capital-efficiency",level:3}],p={toc:m},c="wrapper";function d(e){let{components:a,...s}=e;return(0,r.kt)(c,(0,n.Z)({},p,s,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"amm"},"AMM"),(0,r.kt)("p",null,"Pendle\u2019s V2 AMM is designed specifically for trading yield, and takes advantage of the behaviours of PT and YT."),(0,r.kt)("p",null,"The AMM curve changes to account for yield accrued over time and narrows PT\u2019s price range as it approaches maturity. By concentrating liquidity into a narrow, meaningful range, the capital efficiency to trade yield is increased as PT approaches maturity"),(0,r.kt)("p",null,"Furthermore, by implementing a pseudo-AMM inspired by Notional Finance, we are able to both facilitate PT and YT swaps using just a single pool of liquidity. With a PT/SY pool, PT can be directly traded with SY, while YT trades are also possible via flash swaps."),(0,r.kt)("h2",{id:"swaps"},"Swaps"),(0,r.kt)("p",null,"Both PT and YT are tradeable anytime on Pendle through a single pool of liquidity. This is made possible by implementing a pseudo-AMM with flash swaps."),(0,r.kt)("p",null,"Liquidity pools in Pendle V2 are set up as PT/SY, e.g. PT-aUSDC / SY-aUSDC. Swapping PT is a straightforward process of swapping between the 2 assets in the pool, while swapping YT is enabled via flash swaps in the same pool."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Auto-routing is built in, allowing anyone to trade PTs and YTs with any major asset.")),(0,r.kt)("h2",{id:"flash-swaps"},"Flash Swaps"),(0,r.kt)("p",null,"Flash swaps are possible due to the relationship between PT and YT. As PT and YT can be minted from and redeemed to its underlying SY, we can express the price relationship:"),(0,r.kt)("div",{className:"math math-display"},(0,r.kt)("span",{parentName:"div",className:"katex-display"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"P"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,r.kt)("mi",{parentName:"mrow"},"P"),(0,r.kt)("mi",{parentName:"mrow"},"T"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,r.kt)("mo",{parentName:"mrow"},"+"),(0,r.kt)("mi",{parentName:"mrow"},"P"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,r.kt)("mi",{parentName:"mrow"},"Y"),(0,r.kt)("mi",{parentName:"mrow"},"T"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,r.kt)("mo",{parentName:"mrow"},"="),(0,r.kt)("mi",{parentName:"mrow"},"P"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,r.kt)("mi",{parentName:"mrow"},"U"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"l"),(0,r.kt)("mi",{parentName:"mrow"},"y"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"g"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"P(PT) + P(YT) = P(Underlying)")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,r.kt)("span",{parentName:"span",className:"mopen"},"("),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T"),(0,r.kt)("span",{parentName:"span",className:"mclose"},")"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}}),(0,r.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,r.kt)("span",{parentName:"span",className:"mopen"},"("),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T"),(0,r.kt)("span",{parentName:"span",className:"mclose"},")"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}}),(0,r.kt)("span",{parentName:"span",className:"mrel"},"="),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"P"),(0,r.kt)("span",{parentName:"span",className:"mopen"},"("),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"U"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.01968em"}},"l"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"g"),(0,r.kt)("span",{parentName:"span",className:"mclose"},")")))))),(0,r.kt)("p",null,"Knowing that YT price has an inverted correlation against PT price, we use this price relationship to utilise the PT/SY pool for YT swaps."),(0,r.kt)("p",null,"Buying YT:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Buyer sends SY into the swap contract (auto-routed from any major token)"),(0,r.kt)("li",{parentName:"ol"},"Contract withdraws more SY from the pool"),(0,r.kt)("li",{parentName:"ol"},"Mint PTs and YTs from all of the SY"),(0,r.kt)("li",{parentName:"ol"},"Send the YTs to the buyer"),(0,r.kt)("li",{parentName:"ol"},"The PTs are sold for SY to return the amount from step 2")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Buying YT",src:t(284).Z,title:"Buying YT",width:"1999",height:"1126"})),(0,r.kt)("p",null,"Selling YT:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Seller sends YT into the swap contract"),(0,r.kt)("li",{parentName:"ol"},"Contract borrows an equivalent amount of PT from the pool"),(0,r.kt)("li",{parentName:"ol"},"The YTs and PTs are used to redeem SY"),(0,r.kt)("li",{parentName:"ol"},"SY is sent to the seller (or routed to any major tokens, e.g. ETH, USDC, wBTC, etc)"),(0,r.kt)("li",{parentName:"ol"},"A portion of the SY is sold to the pool for PT to return the amount from step 2")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Selling YT",src:t(7968).Z,title:"Selling YT",width:"1999",height:"1126"})),(0,r.kt)("h2",{id:"key-features"},"Key Features"),(0,r.kt)("h3",{id:"minimal-impermanent-loss-il"},"Minimal Impermanent Loss (IL)"),(0,r.kt)("p",null,"Pendle V2 design ensures that IL is a negligible concern. Pendle\u2019s AMM accounts for PT\u2019s natural price appreciation by shifting the AMM curve to push PT price towards its underlying value as time passes, mitigating time-dependent IL."),(0,r.kt)("p",null,"On top of that, IL from swaps is also mitigated as both assets LP\u2019ed are very highly correlated against one another (e.g. PT-stETH / SY-stETH). If liquidity is provided until maturity, an LP\u2019s position will be equivalent to fully holding the underlying asset since PT essentially appreciates towards the underlying asset."),(0,r.kt)("p",null,"In most cases prior to maturity, PT trades within a yield range and does not fluctuate as much as an asset\u2019s spot price. For example, it\u2019s rational to assume that Aave\u2019s USDC lending rate fluctuates between 0%-15% for a reasonable timeframe (and PT accordingly trades within that yield range). This premise ensures a low IL at any given time as PT price will not deviate too far from the time of liquidity provision."),(0,r.kt)("h3",{id:"customizable-amm"},"Customizable AMM"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Customizable AMM",src:t(6883).Z,title:"Customizable AMM",width:"1600",height:"904"})),(0,r.kt)("p",null,"Pendle\u2019s AMM curve can be customised to cater to tokens with varying yield volatilities. Yields are often cyclical in nature and typically swing between highs and lows. Typically, the floor and ceiling for the yield of a liquid asset are much easier to predict than its price."),(0,r.kt)("p",null,"For example, the annual yield of staked ETH is likely to fluctuate in a band of 0.5-7%. Knowing the rough yield range of an asset enables us to concentrate liquidity within that range, enabling much larger trade sizes at a lower slippage."),(0,r.kt)("h3",{id:"greater-capital-efficiency"},"Greater Capital Efficiency"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"For Liquidity Providers"),"\nSince YT trades are routed through the same PT/SY pool, LPs earn fees from both PT and YT swaps from a single liquidity provision, doubling the yield from LPing."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"For Traders"),"\nRather than having separate pools for YT and PT, concentrating all tokens in a PT/SY pool will result in greater liquidity. This will allow traders to make trades of greater volume without having to worry about much slippage, granting traders greater price certainty."))}d.isMDXComponent=!0},284:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/buying_yt-22c5d12e0c609c2787ae0708639c26f3.png"},6883:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/customizable_amm-b4da107e9ed6c28f3c125a8a40c4ecc3.png"},7968:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/selling_yt-8da5dd7f451f1fa22685572bfb631c97.png"}}]);